<!DOCTYPE html><html lang="en"><head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v3.5.2"><!-- Canonical URL --><link rel="canonical" href="https://paletteovo.moe/"><!-- Primary Meta Tags --><title>飄夢 - Blog</title><meta name="title" content="飄夢 - Blog"><meta name="description" content="Welcome to my website!"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://paletteovo.moe/"><meta property="og:title" content="飄夢 - Blog"><meta property="og:description" content="Welcome to my website!"><meta property="og:image" content="https://paletteovo.moe/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://paletteovo.moe/"><meta property="twitter:title" content="飄夢 - Blog"><meta property="twitter:description" content="Welcome to my website!"><meta property="twitter:image" content="https://paletteovo.moe/blog-placeholder-1.jpg"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_name_.ebb2884f.css" /><script type="module" src="/_astro/hoisted.124216b5.js"></script></head><body><div class="bg-gradient w-100vw h-100vh fixed top-0 right-0 bottom-0 left-0 z--10000"></div><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var b=Object.defineProperty;var f=(c,o,i)=>o in c?b(c,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[o]=i;var l=(c,o,i)=>(f(c,typeof o!="symbol"?o+"":o,i),i);var p;{let c={0:t=>m(t),1:t=>i(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(i(t)),5:t=>new Set(i(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[e,r]=t;return e in c?c[e](r):void 0},i=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o(r)]));customElements.get("astro-island")||customElements.define("astro-island",(p=class extends HTMLElement{constructor(){super(...arguments);l(this,"Component");l(this,"hydrator");l(this,"hydrate",async()=>{var d;if(!this.hydrator||!this.isConnected)return;let e=(d=this.parentElement)==null?void 0:d.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let r=this.querySelectorAll("astro-slot"),a={},h=this.querySelectorAll("template[data-astro-template]");for(let n of h){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("data-astro-template")||"default"]=n.innerHTML,n.remove())}for(let n of r){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("name")||"default"]=n.innerHTML)}let u;try{u=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(n){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),n),n}await this.hydrator(this)(this.Component,u,a,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});l(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),r.disconnect(),this.childrenConnectedCallback()},r=new MutationObserver(()=>{var a;((a=this.lastChild)==null?void 0:a.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});r.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),r=this.getAttribute("client");if(Astro[r]===void 0){window.addEventListener(`astro:${r}`,()=>this.start(),{once:!0});return}Astro[r](async()=>{let a=this.getAttribute("renderer-url"),[h,{default:u}]=await Promise.all([import(this.getAttribute("component-url")),a?import(a):()=>()=>{}]),d=this.getAttribute("component-export")||"default";if(!d.includes("."))this.Component=h[d];else{this.Component=h;for(let n of d.split("."))this.Component=this.Component[n]}return this.hydrator=u,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},l(p,"observedAttributes",["props"]),p))}})();</script><astro-island uid="ZhX5j2" component-url="/_astro/Header.3fd40ab8.js" component-export="default" renderer-url="/_astro/client.0aca0583.js" props="{}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Header&quot;,&quot;value&quot;:&quot;solid-js&quot;}"></astro-island><astro-island uid="1f1vXa" component-url="/_astro/TopBackground.2311355a.js" component-export="default" renderer-url="/_astro/client.0aca0583.js" props="{&quot;class&quot;:[0,&quot;h-100vh items-center justify-center&quot;],&quot;expand&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;TopBackground&quot;,&quot;value&quot;:&quot;solid-js&quot;}" await-children=""><template data-astro-template><h1 class="text-white text-5xl drop-shadow-md text-center lt-sm:text-3xl transition">飄夢 - Blog</h1></template><!--astro:end--></astro-island><main class="py-8 flex flex-col justify-center items-center bg-white"><!-- {
            posts
               .slice(0, 10)
               .map((post, index) => <BlogCard client:load post={post} />)
         }
         {
            posts
               .slice(10, posts.length)
               .map((post, index) => <BlogCard client:visible post={post} />)
         } --><astro-island uid="Z1rCHnh" component-url="/_astro/BlogCardList.7f55b275.js" component-export="default" renderer-url="/_astro/client.0aca0583.js" props="{&quot;posts&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;linux-locale-settings&quot;],&quot;title&quot;:[0,&quot;Linux 系統下關於Locale設定的全記錄(持續更新)&quot;],&quot;pub_date&quot;:[3,&quot;2022-03-25T00:00:00.000Z&quot;],&quot;update_date&quot;:[3,&quot;2023-08-11T00:00:00.000Z&quot;],&quot;excerpt&quot;:[0],&quot;categories&quot;:[0,&quot;Programming&quot;],&quot;tags&quot;:[1,[[0,0]]],&quot;draft&quot;:[0],&quot;thumbnail&quot;:[0],&quot;html&quot;:[0,&quot;&lt;h2&gt;0x0 前言&lt;/h2&gt;\n&lt;p&gt;Linux 下的配置相當混亂，其中一個最明顯的就是 Locale 和輸入法相關設置，由於我找不到一個完整的文檔，所以決定自己來整一個．這裡也會包含 fcitx5/rime 的設置,畢竟這玩意的配置也挺反人類的，官方文檔也不說人話。&lt;/p&gt;\n&lt;h2&gt;0x1 注&lt;/h2&gt;\n&lt;p&gt;解釋會導致文章過長，所以建議自己配合 Google 服用&lt;/p&gt;\n&lt;p&gt;注意環境變量是繼承/由調用者設置的，所以找不到的話可以往上找找&lt;/p&gt;\n&lt;p&gt;包含了被 deprecated 的設置，畢竟誰知道呢&lt;/p&gt;\n&lt;p&gt;雖然文檔說 LC_ALL 不好，但這可能是唯一一個所有程序都專重的設置，而且不會被擅自修改，只要變了那肯定是你手動設置的.&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# 相關環境變量&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LANG&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LANGUAGE&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_CTYPE&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_NUMERIC&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_TIME&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_COLLATE&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_MONETARY&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_MESSAGES&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_PAPER&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_NAME&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_ADDRESS&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_TELEPHONE&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_MEASUREMENT&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_IDENTIFICATION&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;LC_ALL&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;0x2 系統語言&lt;/h2&gt;\n&lt;p&gt;&lt;code&gt;/etc/locale.gen&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/locale.conf&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/default/locale&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/profile&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/profile.d/&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/security/pam_env.conf&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/environment&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/env.d/*&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/systemd/system/user@.service.d/*&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.config/environment.d/*.conf&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.env&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.pam_environment&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.config/locale.conf&lt;/code&gt;&lt;br&gt;&lt;code&gt;$XDG_CONFIG_HOME/locale.conf&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;以及各種你自己的 shell 的 rc 檔，過多所以恕不全部列出&lt;br&gt;&lt;code&gt;$HOME/.profile&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.bash_profile&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.bash_login&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.bashrc&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.zlogin&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.zshrc&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.zshenv&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/bash.bashrc&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/zprofile&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/zsh/zprofile&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.zprofile&lt;/code&gt;&lt;/p&gt;\n&lt;h2&gt;0x3 圖形介面&lt;/h2&gt;\n&lt;p&gt;&lt;code&gt;$HOME/.xinitrc&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.xsessionrc&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.xsession&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.config/environment.d/envvars.conf&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.config/plasma-workspace/env/*&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.config/plasma-locale/env/*&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.config/plasma-localerc&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.config/user-dirs.locale&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.gnomerc&lt;/code&gt;&lt;br&gt;&lt;code&gt;/usr/share/xsessions/*&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.dmrc&lt;/code&gt;&lt;br&gt;&lt;code&gt;$XDG_CONFIG_HOME/autostart/&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.config/autostart/&lt;/code&gt;&lt;br&gt;&lt;code&gt;$XDG_CONFIG_DIRS/autostart/&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/xdg/autostart/&lt;/code&gt;&lt;br&gt;&lt;code&gt;/usr/local/etc/xprofile&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/xprofile&lt;/code&gt;&lt;br&gt;&lt;code&gt;$HOME/.xprofile&lt;/code&gt;&lt;/p&gt;\n&lt;h2&gt;0x4 其它軟件&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;.desktop 等啟動程序可能會包含 LANG 等變量&lt;/li&gt;\n&lt;li&gt;kitty 會自行重置 LANG 等變量&lt;/li&gt;\n&lt;li&gt;KDE 會自行重置&lt;code&gt;$HOME/.config/plasma-localerc&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2&gt;0x5 fcitx5/rime&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;如果遇到奇怪的問題，可以看看 fcitx5-qt fcitx5-gtk 有沒有裝&lt;/li&gt;\n&lt;li&gt;指令行部署 &lt;code&gt;rime_deployer --build ~/.local/share/fcitx5/rime/ /usr/share/rime-data ~/.local/share/fcitx5/rime/build&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;輸入法設置&lt;a href=\&quot;https://wiki.archlinux.org/title/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)\&quot;&gt;https://wiki.archlinux.org/title/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;export&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; GTK_IM_MODULE&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;fcitx&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;export&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; QT_IM_MODULE&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;fcitx&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;export&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; SDL_IM_MODULE&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;fcitx&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;export&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; GLFW_IM_MODULE&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;ibus&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# fcitx5 ibus compaitible for kitty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;export&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; INPUT_METHOD&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;fcitx&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;export&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; XMODIFIERS&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;@im=fcitx&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;0x6 fcitx5/rime wayland&lt;/h2&gt;\n&lt;p&gt;在 KDE wayland 下要支持各種 electron 和 qt/gtk 軟件需要由 kwin 打開 fcitx 並配置 kcm&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;配置虛擬鍵盤&lt;br&gt;－　&lt;img loading=\&quot;lazy\&quot; decoding=\&quot;async\&quot; data-blurhash=\&quot;U4S6Sv-M~S049E9G9ZxW^a9c0M}*01jDn#9H\&quot; width=\&quot;468\&quot; height=\&quot;213\&quot; data-src=\&quot;/_posts/./linux-locale-settings/2023-08-11.1691748894.png?blurhash=U4S6Sv-M~S049E9G9ZxW%5Ea9c0M%7D*01jDn%239H&amp;width=468&amp;height=213\&quot;  data-alt=\&quot;2023-08-11.1691748894.png\&quot; /&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;參考資料&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://www.csslayer.info/wordpress/linux/use-plasma-5-24-to-type-in-alacritty-or-any-other-text-input-v3-client-with-fcitx-5-on-wayland/\&quot;&gt;https://www.csslayer.info/wordpress/linux/use-plasma-5-24-to-type-in-alacritty-or-any-other-text-input-v3-client-with-fcitx-5-on-wayland/&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland\&quot;&gt;https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2&gt;0x7 後記和個人設置&lt;/h2&gt;\n&lt;p&gt;個人用的是 KDE&lt;/p&gt;\n&lt;p&gt;我把所有 LANG 都塞 &lt;code&gt;$HOME/.xprofile&lt;/code&gt; 裡了，用的是 &lt;code&gt;zh_TW.utf8&lt;/code&gt;&lt;br&gt;&lt;code&gt;/etc/default/locale&lt;/code&gt; 和 &lt;code&gt;/etc/locale.conf&lt;/code&gt; 則是 &lt;code&gt;en_US.utf8&lt;/code&gt;&lt;br&gt;輸入法也在 &lt;code&gt;.xprofile&lt;/code&gt; 裡配置&lt;/p&gt;\n&lt;h2&gt;0x8 changelog&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;2023-08-11 更新 kde wayland 下的 fcitx5 配置&lt;/li&gt;\n&lt;/ul&gt;\n&quot;],&quot;body&quot;:[0,&quot;## 0x0 前言\n\nLinux 下的配置相當混亂，其中一個最明顯的就是 Locale 和輸入法相關設置，由於我找不到一個完整的文檔，所以決定自己來整一個．這裡也會包含 fcitx5/rime 的設置,畢竟這玩意的配置也挺反人類的，官方文檔也不說人話。\n\n## 0x1 注\n\n解釋會導致文章過長，所以建議自己配合 Google 服用\n\n注意環境變量是繼承/由調用者設置的，所以找不到的話可以往上找找\n\n包含了被 deprecated 的設置，畢竟誰知道呢\n\n雖然文檔說 LC_ALL 不好，但這可能是唯一一個所有程序都專重的設置，而且不會被擅自修改，只要變了那肯定是你手動設置的.\n\n```bash\n# 相關環境變量\nLANG=\nLANGUAGE=\nLC_CTYPE=\nLC_NUMERIC=\nLC_TIME=\nLC_COLLATE=\nLC_MONETARY=\nLC_MESSAGES=\nLC_PAPER=\nLC_NAME=\nLC_ADDRESS=\nLC_TELEPHONE=\nLC_MEASUREMENT=\nLC_IDENTIFICATION=\nLC_ALL=\n```\n\n## 0x2 系統語言\n\n`/etc/locale.gen`\n`/etc/locale.conf`\n`/etc/default/locale`\n`/etc/profile`\n`/etc/profile.d/`\n`/etc/security/pam_env.conf`\n`/etc/environment`\n`/etc/env.d/*`\n`/etc/systemd/system/user@.service.d/*`\n`$HOME/.config/environment.d/*.conf`\n`$HOME/.env`\n`$HOME/.pam_environment`\n`$HOME/.config/locale.conf`\n`$XDG_CONFIG_HOME/locale.conf`\n\n以及各種你自己的 shell 的 rc 檔，過多所以恕不全部列出\n`$HOME/.profile`\n`$HOME/.bash_profile`\n`$HOME/.bash_login`\n`$HOME/.bashrc`\n`$HOME/.zlogin`\n`$HOME/.zshrc`\n`$HOME/.zshenv`\n`/etc/bash.bashrc`\n`/etc/zprofile`\n`/etc/zsh/zprofile`\n`$HOME/.zprofile`\n\n## 0x3 圖形介面\n\n`$HOME/.xinitrc`\n`$HOME/.xsessionrc`\n`$HOME/.xsession`\n`$HOME/.config/environment.d/envvars.conf`\n`$HOME/.config/plasma-workspace/env/*`\n`$HOME/.config/plasma-locale/env/*`\n`$HOME/.config/plasma-localerc`\n`$HOME/.config/user-dirs.locale`\n`$HOME/.gnomerc`\n`/usr/share/xsessions/*`\n`$HOME/.dmrc`\n`$XDG_CONFIG_HOME/autostart/`\n`$HOME/.config/autostart/`\n`$XDG_CONFIG_DIRS/autostart/`\n`/etc/xdg/autostart/`\n`/usr/local/etc/xprofile`\n`/etc/xprofile`\n`$HOME/.xprofile`\n\n## 0x4 其它軟件\n\n- .desktop 等啟動程序可能會包含 LANG 等變量\n- kitty 會自行重置 LANG 等變量\n- KDE 會自行重置`$HOME/.config/plasma-localerc`\n\n## 0x5 fcitx5/rime\n\n- 如果遇到奇怪的問題，可以看看 fcitx5-qt fcitx5-gtk 有沒有裝\n- 指令行部署 `rime_deployer --build ~/.local/share/fcitx5/rime/ /usr/share/rime-data ~/.local/share/fcitx5/rime/build`\n- 輸入法設置[https://wiki.archlinux.org/title/Fcitx5\\_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)](&lt;https://wiki.archlinux.org/title/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&gt;)\n\n```bash\nexport GTK_IM_MODULE=fcitx\nexport QT_IM_MODULE=fcitx\nexport SDL_IM_MODULE=fcitx\nexport GLFW_IM_MODULE=ibus # fcitx5 ibus compaitible for kitty\n\nexport INPUT_METHOD=fcitx\nexport XMODIFIERS=@im=fcitx\n```\n\n## 0x6 fcitx5/rime wayland\n\n在 KDE wayland 下要支持各種 electron 和 qt/gtk 軟件需要由 kwin 打開 fcitx 並配置 kcm\n\n- 配置虛擬鍵盤\n  －　![2023-08-11.1691748894.png](./linux-locale-settings/2023-08-11.1691748894.png)\n\n參考資料\n\n- https://www.csslayer.info/wordpress/linux/use-plasma-5-24-to-type-in-alacritty-or-any-other-text-input-v3-client-with-fcitx-5-on-wayland/\n- https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland\n\n## 0x7 後記和個人設置\n\n個人用的是 KDE\n\n我把所有 LANG 都塞 `$HOME/.xprofile` 裡了，用的是 `zh_TW.utf8`\n`/etc/default/locale` 和 `/etc/locale.conf` 則是 `en_US.utf8`\n輸入法也在 `.xprofile` 裡配置\n\n## 0x8 changelog\n\n- 2023-08-11 更新 kde wayland 下的 fcitx5 配置\n&quot;]}],[0,{&quot;id&quot;:[0,&quot;intel-nvidia-dual-gpu-overclock&quot;],&quot;title&quot;:[0,&quot;Intel/NVIDIA 同時使用集顯+獨顯及超頻&quot;],&quot;pub_date&quot;:[3,&quot;2022-03-19T00:00:00.000Z&quot;],&quot;update_date&quot;:[0],&quot;excerpt&quot;:[0],&quot;categories&quot;:[0,&quot;Programming&quot;],&quot;tags&quot;:[1,[[0,0]]],&quot;draft&quot;:[0],&quot;thumbnail&quot;:[0],&quot;html&quot;:[0,&quot;&lt;h2&gt;0x0 前言&lt;/h2&gt;\n&lt;p&gt;最近用上了 Manjaro Linux，在翻看顯卡驅動相關的時後發現可以優先集顯然後獨顯不輸出，就可以讓獨顯全力挖礦煉丹了。於是就動手弄了起來。個人使用的是閉源驅動，本文開源驅動相關的配置只是一個方向，我也不確定能不能用。&lt;/p&gt;\n&lt;h2&gt;0x1 啟用集顯&lt;/h2&gt;\n&lt;p&gt;在我電腦上如果插上了顯卡的話集顯是默認關閉的，需要在BIOS裡啟用然後指定是集顯輸出，當然線也要插到主板的插口上。這邊就自己找找吧，不附圖了，基本上是寫着IGFX，集成顯卡，之類的，一個個翻翻看。&lt;/p&gt;\n&lt;h2&gt;0x2 安裝/啟用驅動&lt;/h2&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;pacman&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-S&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;xf86-video-intel&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;mesa&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# if proprietary driver&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;pacman&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-S&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;xf86-video-intel&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;xf86-video-nouveau&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;mesa&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nouveau&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# if open-source driver&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;vim&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;/etc/mkinitcpio.conf&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# 修改MODULES這行加上這些module, 自行編譯內核用dkms的可以不加 nvidia*&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;MODULES&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;i915&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia_modeset&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia_uvm&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia_drm&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;:wq&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;mkinitcpio&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-P&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;0x3 xorg設定集顯和獨顯&lt;/h2&gt;\n&lt;p&gt;記下pci bus id&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;lspci&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;...&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;00:02.0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;VGA&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;compatible&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;controller:&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;Intel&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;Corporation&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;HD&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;Graphics&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;630&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (rev &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;04&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;...&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;01:00.0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;VGA&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;compatible&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;controller:&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;NVIDIA&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;Corporation&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;GA106&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; [GeForce &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;RTX&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;3060&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;Lite&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;Hash&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;Rate]&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (rev &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;a1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;偽裝出一個顯示屏&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;pacman&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-S&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;read-edid&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;get-edid&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-m&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;/usr/share/X11/xorg.conf.d/edid.bin&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;vim&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;/etc/X11/xorg.conf&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# 加入&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Section&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;ServerLayout&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Identifier&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;     &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;layout&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Screen&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;  &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;intel&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Screen&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;  &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;nvidia&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;InputDevice&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Keyboard0&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;CoreKeyboard&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;InputDevice&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Mouse0&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;CorePointer&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;EndSection&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Section&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Device&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Identifier&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;     &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;intel&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Driver&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;intel&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;BusID&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;          &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;PCI:0:2:0&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Option&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;AccelMethod&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;SNA&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Option&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;TearFree&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;on&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;EndSection&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Section&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Device&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Identifier&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;     &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;nvidia&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Driver&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;          &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;nvidia&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;BusID&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;          &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;PCI:1:0:0&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;EndSection&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Section&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Screen&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Identifier&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;     &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;intel&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Device&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;intel&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;DefaultDepth&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;SubSection&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;     &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Display&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;        &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Depth&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;       &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;EndSubSection&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;EndSection&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Section&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Screen&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Identifier&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;     &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;nvidia&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Device&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;nvidia&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Option&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;AllowEmptyInitialConfiguration&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;on&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Option&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;UseDisplayDevice&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;none&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Option&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Coolbits&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;28&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Option&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;ConnectedMonitor&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;DFP-0&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;Option&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;CustomEDID&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;DFP-0:/usr/share/X11/xorg.conf.d/edid.bin&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;EndSection&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;0x4 超頻&lt;/h2&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;pacman&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-S&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia-utils&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia-smi&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-i&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-pl&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;120&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# powerlimit, 限制功耗&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia-smi&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-i&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-lmc&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;8000&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# lock memory clock 鎖定內存頻率&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia-smi&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-i&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-lgc&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1500&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# lock gpu clock 鎖定GPU頻率&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;0x5 用獨顯跑程序&lt;/h2&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;sudo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;pacman&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;-S&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;nvidia-prime&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;prime-run&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;glxinfo&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;grep&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;OpenGL renderer&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;OpenGL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;renderer&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;string:&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;NVIDIA&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;GeForce&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;RTX&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;3060&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;/PCIe/SSE2&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;參考資料&lt;/h2&gt;\n&lt;p&gt;&lt;a href=\&quot;https://kodi.wiki/view/Archive:Creating_and_using_edid.bin_via_xorg.conf\&quot;&gt;https://kodi.wiki/view/Archive:Creating_and_using_edid.bin_via_xorg.conf&lt;/a&gt;&lt;br&gt;&lt;a href=\&quot;https://wiki.archlinux.org/title/intel_graphics\&quot;&gt;https://wiki.archlinux.org/title/intel_graphics&lt;/a&gt;&lt;br&gt;&lt;a href=\&quot;https://wiki.archlinux.org/title/PRIME\&quot;&gt;https://wiki.archlinux.org/title/PRIME&lt;/a&gt;&lt;/p&gt;\n&quot;],&quot;body&quot;:[0,&quot;## 0x0 前言\n\n最近用上了 Manjaro Linux，在翻看顯卡驅動相關的時後發現可以優先集顯然後獨顯不輸出，就可以讓獨顯全力挖礦煉丹了。於是就動手弄了起來。個人使用的是閉源驅動，本文開源驅動相關的配置只是一個方向，我也不確定能不能用。\n\n## 0x1 啟用集顯\n\n在我電腦上如果插上了顯卡的話集顯是默認關閉的，需要在BIOS裡啟用然後指定是集顯輸出，當然線也要插到主板的插口上。這邊就自己找找吧，不附圖了，基本上是寫着IGFX，集成顯卡，之類的，一個個翻翻看。\n\n## 0x2 安裝/啟用驅動\n\n```bash\n$ sudo pacman -S xf86-video-intel mesa nvidia # if proprietary driver\n$ sudo pacman -S xf86-video-intel xf86-video-nouveau mesa nouveau # if open-source driver\n\n$ sudo vim /etc/mkinitcpio.conf\n\n# 修改MODULES這行加上這些module, 自行編譯內核用dkms的可以不加 nvidia*\nMODULES=(i915 nvidia nvidia_modeset nvidia_uvm nvidia_drm)\n\n:wq\n\n$ sudo mkinitcpio -P\n```\n\n## 0x3 xorg設定集顯和獨顯\n\n記下pci bus id\n\n```bash\n$ lspci\n...\n00:02.0 VGA compatible controller: Intel Corporation HD Graphics 630 (rev 04)\n...\n01:00.0 VGA compatible controller: NVIDIA Corporation GA106 [GeForce RTX 3060 Lite Hash Rate] (rev a1)\n...\n```\n\n偽裝出一個顯示屏\n\n```bash\n$ pacman -S read-edid\n$ sudo get-edid -m 0 &gt; /usr/share/X11/xorg.conf.d/edid.bin\n```\n\n```bash\n$ sudo vim /etc/X11/xorg.conf\n\n# 加入\nSection \&quot;ServerLayout\&quot;\n    Identifier     \&quot;layout\&quot;\n    Screen      0  \&quot;intel\&quot; 0 0\n    Screen      1  \&quot;nvidia\&quot; 0 0\n    InputDevice    \&quot;Keyboard0\&quot; \&quot;CoreKeyboard\&quot;\n    InputDevice    \&quot;Mouse0\&quot; \&quot;CorePointer\&quot;\nEndSection\n\nSection \&quot;Device\&quot;\n    Identifier     \&quot;intel\&quot;\n    Driver         \&quot;intel\&quot;\n    BusID          \&quot;PCI:0:2:0\&quot;\n    Option         \&quot;AccelMethod\&quot; \&quot;SNA\&quot;\n    Option         \&quot;TearFree\&quot; \&quot;on\&quot;\nEndSection\n\nSection \&quot;Device\&quot;\n    Identifier     \&quot;nvidia\&quot;\n    Driver          \&quot;nvidia\&quot;\n    BusID          \&quot;PCI:1:0:0\&quot;\nEndSection\n\nSection \&quot;Screen\&quot;\n    Identifier     \&quot;intel\&quot;\n    Device         \&quot;intel\&quot;\n    DefaultDepth    24\n    SubSection     \&quot;Display\&quot;\n        Depth       24\n    EndSubSection\nEndSection\n\nSection \&quot;Screen\&quot;\n    Identifier     \&quot;nvidia\&quot;\n    Device         \&quot;nvidia\&quot;\n    Option         \&quot;AllowEmptyInitialConfiguration\&quot; \&quot;on\&quot;\n    Option         \&quot;UseDisplayDevice\&quot; \&quot;none\&quot;\n    Option         \&quot;Coolbits\&quot; \&quot;28\&quot;\n    Option         \&quot;ConnectedMonitor\&quot; \&quot;DFP-0\&quot;\n    Option         \&quot;CustomEDID\&quot; \&quot;DFP-0:/usr/share/X11/xorg.conf.d/edid.bin\&quot;\nEndSection\n```\n\n\n## 0x4 超頻\n```bash\n$ sudo pacman -S nvidia-utils\n$ sudo nvidia-smi -i 0 -pl 120 # powerlimit, 限制功耗\n$ sudo nvidia-smi -i 0 -lmc 8000 # lock memory clock 鎖定內存頻率\n$ sudo nvidia-smi -i 0 -lgc 1500 # lock gpu clock 鎖定GPU頻率\n```\n\n## 0x5 用獨顯跑程序\n\n```bash\n$ sudo pacman -S nvidia-prime\n$ prime-run glxinfo | grep \&quot;OpenGL renderer\&quot;\nOpenGL renderer string: NVIDIA GeForce RTX 3060/PCIe/SSE2\n```\n\n## 參考資料\n\nhttps://kodi.wiki/view/Archive:Creating_and_using_edid.bin_via_xorg.conf\nhttps://wiki.archlinux.org/title/intel_graphics\nhttps://wiki.archlinux.org/title/PRIME\n&quot;]}],[0,{&quot;id&quot;:[0,&quot;webm-hardware-acceleration&quot;],&quot;title&quot;:[0,&quot;WebM的超高CPU佔用問題 (Firefox/Chrome/WallpaperEngine)&quot;],&quot;pub_date&quot;:[3,&quot;2021-11-05T00:00:00.000Z&quot;],&quot;update_date&quot;:[0],&quot;excerpt&quot;:[0],&quot;categories&quot;:[0,&quot;Programming&quot;],&quot;tags&quot;:[1,[[0,0]]],&quot;draft&quot;:[0],&quot;thumbnail&quot;:[0],&quot;html&quot;:[0,&quot;&lt;h2&gt;TL;DR&lt;/h2&gt;\n&lt;p&gt;如果你只是來找解決方案的話：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;請確定你更新到了最新的 Windows Update&lt;/li&gt;\n&lt;li&gt;請確定你的顯卡驅動已經是最新的了&lt;/li&gt;\n&lt;li&gt;請確定你的顯卡支持 WebM(VP9) 硬解&lt;/li&gt;\n&lt;li&gt;根據此教程安裝 LAV (右上角可選擇語言) (Using LAV and DirectShow | Wallpaper Engine - Troubleshooting &amp;amp; FAQ)[&lt;a href=\&quot;https://help.wallpaperengine.io/en/videos/lav.html#_1-install-lav%5D\&quot;&gt;https://help.wallpaperengine.io/en/videos/lav.html#_1-install-lav]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;安裝微軟的 VP9解碼擴展 (Get VP9 Video Extensions - Microsoft Store)[&lt;a href=\&quot;https://www.microsoft.com/en-us/p/vp9-video-extensions/9n4d0msmp0pt?activetab=pivot:overviewtab%5D\&quot;&gt;https://www.microsoft.com/en-us/p/vp9-video-extensions/9n4d0msmp0pt?activetab=pivot:overviewtab]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;摸摸你家可愛的小貓&lt;/li&gt;\n&lt;li&gt;現在你應該可以看到你的 GPU 終於不是 0% 佔用了&lt;br&gt;&lt;a href=\&quot;/_posts/example.png\&quot;&gt;Before&lt;/a&gt;&lt;br&gt;&lt;a href=\&quot;/_posts/example.png\&quot;&gt;After&lt;/a&gt;&lt;br&gt;如果你不成功，可以留言和我說說，我可能也可能不會看。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2&gt;0x0 前言&lt;/h2&gt;\n&lt;p&gt;整件事基本上是從 Wallpaper Engine 引起的，前兩天試圖補了幀然後給桌面換一個高幀的視頻桌布，而且還想加特效，於是就選了一個好看的改了起來。&lt;/p&gt;\n&lt;h2&gt;0x1 Wallpaper Engine 的 Web 不支持 MP4&lt;/h2&gt;\n&lt;p&gt;不過這也不是甚麼大問題，換個格式就好了&lt;del&gt;，雖然折騰ffmpeg的無損轉換也花了好久&lt;/del&gt;。&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292e\&quot;&gt;ffmpeg -i input.mp4 -c:v libvpx-vp9 -threads 8 -lossless 1 -filter:v fps=60 output.webm&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;0x2 超高的 CPU 佔用&lt;/h2&gt;\n&lt;p&gt;非常高，基本上把CPU給佔滿了，這種情況顯然是不可能正常用電腦的，但視頻一般都是GPU解碼，不應該是CPU，所以很明顯視頻硬件加速出了問題。但是 VLC 是可以正常播放的。&lt;/p&gt;\n&lt;p&gt;但是，我翻遍了谷歌，翻遍了 steam 論壇，都沒找到任何線索，不得不說這是有點離譜的，我估計是因為根本沒人用 webm，大多數純視頻壁紙都是 mp4。而且 Wallpaper Engine 並不直接支持 WebM 的視頻壁紙，所以只有少數支持了自定義視頻的網頁背景會遇到這個問題。&lt;/p&gt;\n&lt;p&gt;於是，我去翻了翻 Wallpaper Engine 的 F&amp;amp;Q，找到了(Using LAV and DirectShow | Wallpaper Engine - Troubleshooting &amp;amp; FAQ)[&lt;a href=\&quot;https://help.wallpaperengine.io/en/videos/lav.html#_1-install-lav%5D%EF%BC%8C%E6%88%90%E5%8A%9F%E8%A7%A3%E6%B1%BA%E4%BA%86%E7%9B%B4%E6%8E%A5%E6%92%AD%E6%94%BE\&quot;&gt;https://help.wallpaperengine.io/en/videos/lav.html#_1-install-lav]，成功解決了直接播放&lt;/a&gt; WebM 的加速問題。&lt;/p&gt;\n&lt;p&gt;雖然但是，為了加上 kirakira 的特效，我要在 Web 裡播放，但在Ｗeb裡播放時的佔用還是很高啊。於是考慮到他是 Web 播放，我先後用 Firefox 和 Edge 試着播放，發現他們的佔用也很高，所以基本上可以確定是瀏覽器和硬解的問題。&lt;/p&gt;\n&lt;p&gt;然而在 edge://gpu 裡可以明顯看到， vp9 硬件加速是打開了的，所以是甚麼原因呢？&lt;/p&gt;\n&lt;p&gt;於是在一輪輪的搜索下(花了好幾個小時查資料試錯，這裡就不累贅了，雖然一堆人吐槽WebM慢，但沒人給出解決方法)，我從一個 reddit 的評論裡找到了這個&lt;a href=\&quot;https://www.microsoft.com/en-us/p/vp9-video-extensions/9n4d0msmp0pt\&quot;&gt;Get VP9 Video Extensions - Microsoft Store&lt;/a&gt; (抱歉我已經找不回那個帖子了，畢竟我是過了好一會才想起來寫一篇文章說說這個)&lt;/p&gt;\n&lt;p&gt;裝上後可以很明顯看到 GPU 的佔用終於上升了，但我認為可能並不是真的解決了，按照 VP9 Video Extensions 的描述是給沒有硬體加速的人用的，所以看似解決了，但其實並不是直接交給GPU解碼VP9，不過至少他終於不把 CPU 給佔滿了。&lt;/p&gt;\n&lt;h2&gt;0x3 後記&lt;/h2&gt;\n&lt;p&gt;待我有空的時候可能會再研究研究為甚麼不能加速，3060總不至於連VP9編碼都不支持吧，話說我也沒找到支持列表，這裡還是建議 NVIDIA 爬一爬，我甚至覺得可能是 Win11 的問題，但我暫時也沒時間去重裝甚至降級，所以就只能先放着了。&lt;/p&gt;\n&quot;],&quot;body&quot;:[0,&quot;## TL;DR\n如果你只是來找解決方案的話：\n\n1. 請確定你更新到了最新的 Windows Update\n2. 請確定你的顯卡驅動已經是最新的了\n3. 請確定你的顯卡支持 WebM(VP9) 硬解\n4. 根據此教程安裝 LAV (右上角可選擇語言) (Using LAV and DirectShow | Wallpaper Engine - Troubleshooting &amp; FAQ)[https://help.wallpaperengine.io/en/videos/lav.html#_1-install-lav]\n5. 安裝微軟的 VP9解碼擴展 (Get VP9 Video Extensions - Microsoft Store)[https://www.microsoft.com/en-us/p/vp9-video-extensions/9n4d0msmp0pt?activetab=pivot:overviewtab]\n6. 摸摸你家可愛的小貓\n7. 現在你應該可以看到你的 GPU 終於不是 0% 佔用了\n   [Before](example.png)\n   [After](example.png)\n   如果你不成功，可以留言和我說說，我可能也可能不會看。\n\n## 0x0 前言\n\n整件事基本上是從 Wallpaper Engine 引起的，前兩天試圖補了幀然後給桌面換一個高幀的視頻桌布，而且還想加特效，於是就選了一個好看的改了起來。\n\n## 0x1 Wallpaper Engine 的 Web 不支持 MP4\n\n不過這也不是甚麼大問題，換個格式就好了~，雖然折騰ffmpeg的無損轉換也花了好久~。\n\n```\nffmpeg -i input.mp4 -c:v libvpx-vp9 -threads 8 -lossless 1 -filter:v fps=60 output.webm\n```\n\n## 0x2 超高的 CPU 佔用\n\n非常高，基本上把CPU給佔滿了，這種情況顯然是不可能正常用電腦的，但視頻一般都是GPU解碼，不應該是CPU，所以很明顯視頻硬件加速出了問題。但是 VLC 是可以正常播放的。\n\n但是，我翻遍了谷歌，翻遍了 steam 論壇，都沒找到任何線索，不得不說這是有點離譜的，我估計是因為根本沒人用 webm，大多數純視頻壁紙都是 mp4。而且 Wallpaper Engine 並不直接支持 WebM 的視頻壁紙，所以只有少數支持了自定義視頻的網頁背景會遇到這個問題。\n\n於是，我去翻了翻 Wallpaper Engine 的 F&amp;Q，找到了(Using LAV and DirectShow | Wallpaper Engine - Troubleshooting &amp; FAQ)[https://help.wallpaperengine.io/en/videos/lav.html#_1-install-lav]，成功解決了直接播放 WebM 的加速問題。\n\n雖然但是，為了加上 kirakira 的特效，我要在 Web 裡播放，但在Ｗeb裡播放時的佔用還是很高啊。於是考慮到他是 Web 播放，我先後用 Firefox 和 Edge 試着播放，發現他們的佔用也很高，所以基本上可以確定是瀏覽器和硬解的問題。\n\n然而在 edge://gpu 裡可以明顯看到， vp9 硬件加速是打開了的，所以是甚麼原因呢？\n\n於是在一輪輪的搜索下(花了好幾個小時查資料試錯，這裡就不累贅了，雖然一堆人吐槽WebM慢，但沒人給出解決方法)，我從一個 reddit 的評論裡找到了這個[Get VP9 Video Extensions - Microsoft Store](https://www.microsoft.com/en-us/p/vp9-video-extensions/9n4d0msmp0pt) (抱歉我已經找不回那個帖子了，畢竟我是過了好一會才想起來寫一篇文章說說這個)\n\n裝上後可以很明顯看到 GPU 的佔用終於上升了，但我認為可能並不是真的解決了，按照 VP9 Video Extensions 的描述是給沒有硬體加速的人用的，所以看似解決了，但其實並不是直接交給GPU解碼VP9，不過至少他終於不把 CPU 給佔滿了。\n\n## 0x3 後記\n\n待我有空的時候可能會再研究研究為甚麼不能加速，3060總不至於連VP9編碼都不支持吧，話說我也沒找到支持列表，這裡還是建議 NVIDIA 爬一爬，我甚至覺得可能是 Win11 的問題，但我暫時也沒時間去重裝甚至降級，所以就只能先放着了。\n&quot;]}],[0,{&quot;id&quot;:[0,&quot;scala-script&quot;],&quot;title&quot;:[0,&quot;讓Scala的編譯和啟動快一丟丟&quot;],&quot;pub_date&quot;:[3,&quot;2021-11-04T00:00:00.000Z&quot;],&quot;update_date&quot;:[0],&quot;excerpt&quot;:[0],&quot;categories&quot;:[0,&quot;Programming&quot;],&quot;tags&quot;:[1,[[0,0]]],&quot;draft&quot;:[0],&quot;thumbnail&quot;:[0],&quot;html&quot;:[0,&quot;&lt;p&gt;真實年更*(:3」∠)*&lt;br&gt;因為各種各樣的原因想試着日常用用 Scala 了，可是用作腳本的話編譯速度和啟動速度實在是太ー慢ー了，於是這裡就來試着調教一下讓 Scala 稍微能在日常用一點。&lt;/p&gt;\n&lt;h2&gt;編譯&lt;/h2&gt;\n&lt;p&gt;對於編譯其實沒有甚麼辦法，畢竟我菜。上網搜索了一會發現雖然有不少增量編譯等等，但似乎都是基於 sbt 等建構工具，一般都給大項目才能用，對腳本來說貌似意義不大。&lt;/p&gt;\n&lt;h2&gt;Dotty&lt;/h2&gt;\n&lt;p&gt;再找找吧，發現 Scala 好像要出一個 Dotty 的編譯器，聽說編譯速度快了 20%？蚊子再小也是肉，趕緊下載一個來試試。&lt;br&gt;嗯，所以要怎麼用呢，dotc 在哪裡，好像沒有 dotc.bat,好像不支持 Windows 。繼續搜搜，找到了大佬翻譯的 Windows 版的 Link，不錯。&lt;/p&gt;\n&lt;p&gt;下載，編譯，崩潰，一氣呵成。&lt;br&gt;&lt;img loading=\&quot;lazy\&quot; decoding=\&quot;async\&quot; data-blurhash=\&quot;U48NR%~CR%Rj^+nit7ozu4S~%Mxa?bWBR*jZ\&quot; width=\&quot;598\&quot; height=\&quot;176\&quot; data-src=\&quot;/_posts/./scala-script/Snipaste_2020-02-15_10-21-35.png?blurhash=U48NR%25~CR%25Rj%5E%2Bnit7ozu4S~%25Mxa%3FbWBR*jZ&amp;width=598&amp;height=176\&quot;   /&gt;&lt;/p&gt;\n&lt;p&gt;一看，原來 Dotty 改了不少格式，我都還沒開始學 Scala 2 就已經過氣了嗎。&lt;br&gt;改了改，總算過了編譯，運行，崩潰，哦吼。&lt;br&gt;&lt;img loading=\&quot;lazy\&quot; decoding=\&quot;async\&quot; data-blurhash=\&quot;U5AdAt~q00Ri%Mt7%Mxu4nWB-;xa?bM{M{t7\&quot; width=\&quot;567\&quot; height=\&quot;175\&quot; data-src=\&quot;/_posts/./scala-script/Snipaste_2020-02-15_10-26-15.png?blurhash=U5AdAt~q00Ri%25Mt7%25Mxu4nWB-%3Bxa%3FbM%7BM%7Bt7&amp;width=567&amp;height=175\&quot;   /&gt;&lt;/p&gt;\n&lt;p&gt;這甚麼，初始化崩潰？NPE?這玩意初始化時都干了甚麼？仔細想了想，有差別的地方可能是因為直接繼承了 App 而不寫 main 了？改改，過了，可是為甚麼呢？&lt;/p&gt;\n&lt;p&gt;簡單推測一下，估計是 class 初始化時 args 還沒有被初始化，然後不知為甚麼(大概是 bug 吧)執行了本應該在 main 裡才執行的 parseArgs。然後就 NPE 了。&lt;/p&gt;\n&lt;h2&gt;增量編譯 (?)&lt;/h2&gt;\n&lt;p&gt;可是編譯還是好慢，不過雖然沒辦法繼續加快，但我可以減少編譯的次數嘛。於是，手寫了一個簡單的增量編譯，只在檔案有修改的時候才會重新編譯，雖然暫時只對單個檔案有效。&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;param&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;($file&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $cp&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $run)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$dest &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;D:\\TEMP&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$sourceDirectory &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Get-Item&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $file).DirectoryName&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$className &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Get-Item&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $file).Basename&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$destFile &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $dest &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $className &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;.class&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$A &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Test-Path&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;Path $destFile&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-not&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $A &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-or&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ((&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Get-Item&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $destFile).LastWriteTime &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-lt&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Get-Item&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $file).LastWriteTime)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# # for scala fsc&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# fsc -d $dest $file&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# for dotty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   cmd &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;c &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;C:\\dotty-0.22.0-RC1\\bin\\dotc&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-classpath&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$sourceDirectory&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$cp&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-join&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-d&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$dest&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$file&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-not&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;$?&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;exit&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# faster startup (maybe)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$JVM_ARGS &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;@&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-Xshare:on&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-XX:-TieredCompilation&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-XX:TieredStopAtLevel=1&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-client&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$JVM_JARGS &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;@&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-JXshare:on&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-JXX:-TieredCompilation&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-JXX:TieredStopAtLevel=1&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-Jclient&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# # for scala&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# java.exe @JVM_ARGS &amp;quot;-Dscala.usejavacp=true&amp;quot; &amp;quot;-cp&amp;quot; &amp;quot;C:\\scala\\lib\\*&amp;quot; &amp;quot;scala.tools.nsc.MainGenericRunner&amp;quot; @JVM_JARGS &amp;quot;-cp&amp;quot; $dest $className @run&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# for dotty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;java.exe&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; @JVM_ARGS &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;classpath &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;C:\\DOTTY-~1.0-R\\lib\\dotty-library_0.22-0.22.0-RC1.jar;C:\\DOTTY-~1.0-R\\lib\\scala-library-2.13.1.jar;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$cp&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-join&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$dest&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $className @run&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# # for classloader server mode&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# python D:\\palette\\Run\\cl.py $dest $className @run&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;這玩意非常簡單，只是檢查了一下最後修改時間，不過管用就行嘛。&lt;/p&gt;\n&lt;h2&gt;中段&lt;/h2&gt;\n&lt;p&gt;其實 dotty 的啟動速度已經到了可以接受的範圍了，但，有沒有辦法更快呢？&lt;/p&gt;\n&lt;h2&gt;JVM&lt;/h2&gt;\n&lt;p&gt;事實上我們可以先把 JVM 開着，動態加載 Class，甚至複用 Class 來減少 JVM 和 Class 的載入時間。Github 上已經有 NailGun 和 Drip 實現了，可惜一個跑不起來(也許是 JDK 版本太高)一個不支援 Windows，只好自己做了，幸好並不算難寫。&lt;/p&gt;\n&lt;p&gt;伺服器:&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.File;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.lang.reflect.InvocationTargetException;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.lang.reflect.Method;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.URL;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.URLClassLoader;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.security.Permission;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.util.ArrayList;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.util.Arrays;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.util.stream.Collectors;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.BufferedReader;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.IOException;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.InputStream;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.InputStreamReader;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.PrintStream;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.MalformedURLException;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.ServerSocket;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.Socket;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;class&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;CLServer&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;private&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;final&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;int&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; PORT &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;8080&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;final&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; PrintStream _out &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; System.out;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;final&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; PrintStream _err &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; System.err;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ClassLoader cl;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;final&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;boolean&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; DEBUG &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;true&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;message&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (DEBUG) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;print&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;D&amp;gt; &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(message);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;error&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;message&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;print&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;E&amp;gt; &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(message);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;message&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;print&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;I&amp;gt; &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(message);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;main&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;args&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; NoSuchMethodException, SecurityException, IllegalAccessException,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         IllegalArgumentException, InvocationTargetException, IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setSecurityManager&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;SecurityManager&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         @&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;Override&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;checkExit&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;int&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;status&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throw&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;RuntimeException&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Blocking System.exit();&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         @&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;Override&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;checkPermission&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(Permission &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;p&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      });&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      cl &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; URLClassLoader.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;newInstance&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;URL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] {}, CLServer.class.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getClassLoader&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (ServerSocket server &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;ServerSocket&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(PORT)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Server is listening &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; PORT);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;while&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;true&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  Socket s &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; server.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;accept&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;handleSocket&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (IOException &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setOut&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setErr&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_err);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  e.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;printStackTrace&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;finally&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setOut&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setErr&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_err);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (Error | Exception &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;continue anyway&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;handleSocket&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(Socket &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      InputStream is &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; s.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getInputStream&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      PrintStream out &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;PrintStream&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(s.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getOutputStream&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      BufferedReader in &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;BufferedReader&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;InputStreamReader&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(is));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setOut&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setErr&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;handleCommand&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(in, out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;finally&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;flush&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setOut&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setErr&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_err);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         in.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;close&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;close&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         is.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;close&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         s.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;close&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;handleCommand&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(BufferedReader &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, PrintStream &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;out&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Packet: &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      String cmd &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; in.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (cmd.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#cp&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#cp&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         String data &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; in.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(data);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            CLServer.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(data);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (Error | Exception &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            e.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;printStackTrace&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (cmd.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#run&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#run&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         ArrayList&amp;lt;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;&amp;gt; cps &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ArrayList&amp;lt;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;&amp;gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         String name &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         ArrayList&amp;lt;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;&amp;gt; args &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ArrayList&amp;lt;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;&amp;gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;// 0 for cp, 1 for name, 2 for args&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;int&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; state &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         String line;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;while&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ((line &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; in.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;()) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;!=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; line.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;length&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (line.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#cp&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               state &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (line.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#name&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               state &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (line.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#args&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               state &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;switch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (state) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;case&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  cps.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;add&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;break&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;case&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  name &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; line;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;break&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;case&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  args.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;add&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (name &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;!=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            CLServer.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;callMain&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addTempURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(cps.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toArray&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] {})), name, args.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toArray&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] {}), out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;E&amp;gt; Missing class name&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;error&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Missing class name&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;End Packet&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; NoSuchMethodException, SecurityException, IllegalAccessException,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         IllegalArgumentException, InvocationTargetException, MalformedURLException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      Method method &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; URLClassLoader.class.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getDeclaredMethod&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;addURL&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;Class&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] { URL.class });&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      File f &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;File&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      method.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setAccessible&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;true&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Adding &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      method.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;invoke&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(cl, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;Object&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] { f.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toURI&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;() });&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ClassLoader &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addTempURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; MalformedURLException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      ClassLoader newCl &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; URLClassLoader.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;newInstance&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(Arrays.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;stream&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(s).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(x &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Adding temp url &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; x);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;return&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;File&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(x).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toURI&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (MalformedURLException &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throw&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;RuntimeException&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(e);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(Collectors.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toList&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;()).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toArray&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;URL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] {}), cl);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;return&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; newCl;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;callMain&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;className&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;args&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, PrintStream &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;out&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;callMain&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(cl, className, args, out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;callMain&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(ClassLoader &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;cl&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;className&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;args&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, PrintStream &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;out&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Running &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; className);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         cl.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;loadClass&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(className).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getMethod&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;main&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[].class).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;invoke&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, (Object) args);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (InvocationTargetException &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         e.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getCause&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;printStackTrace&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (Error | Exception &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         e.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;printStackTrace&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;客戶端:&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; socket&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; select&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; sys&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;host &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;127.0.0.1&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;port &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;8080&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;def&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;send&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;data):&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   s &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; socket.socket(socket.&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;AF_INET&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, socket.&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   s.connect((host,port))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   s.send((&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\n&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;.join(data) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\n\\n\\n&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;).encode())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   ready &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; select.select([s], [], [], &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   response &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;b&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;while&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;True&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ready[&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;]:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         response &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; s.recv(&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1024&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;not&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; response:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;break&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;print&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(response.decode(), &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;end&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   s.close ()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# # for scala&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# send(&amp;quot;#cp&amp;quot;, &amp;quot;C:\\\\scala\\\\lib\\\\scala-compiler.jar&amp;quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# send(&amp;quot;#cp&amp;quot;, &amp;quot;C:\\\\scala\\\\lib\\\\scala-library.jar&amp;quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# send(&amp;quot;#run&amp;quot;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;#    &amp;quot;#name&amp;quot;, &amp;quot;scala.tools.nsc.MainGenericRunner&amp;quot;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;#    &amp;quot;#args&amp;quot;, &amp;quot;-Jclient&amp;quot;, &amp;quot;-cp&amp;quot;, &amp;quot;C:\\\\scala\\\\lib\\\\scala-library.jar;&amp;quot;+sys.argv[1],&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;#    *sys.argv[2:]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# for dotty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;send(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#run&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#cp&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, sys.argv[&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;],&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;C:&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;DOTTY-~1.0-R&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;lib&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;scala-library-2.13.1.jar&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;C:&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;DOTTY-~1.0-R&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;lib&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;dotty-library_0.22-0.22.0-RC1.jar&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#name&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, sys.argv[&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;],&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#args&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;sys.argv[&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;:]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;代碼非常簡單，自定義了一套協議，用來加入 cp 和執行 main 函數，和一些不太好看的黑科技。&lt;br&gt;可惜對 Dotty 的支持一般，不太清楚為甚麼但 Dotty 如果不每次加載的話輸出會消失，不過 Scala 沒這問題，而且 Dotty 的啟動其實也相當快，問題不大。&lt;/p&gt;\n&lt;h2&gt;結語&lt;/h2&gt;\n&lt;p&gt;代碼在 github 的 CodeColle/{Scala|Java}裡可以找到&lt;br&gt;目前還只支持單文件，以後有機會/需求可能會再繼續弄吧，一開始是因為 Python 太慢所以想找個新語言，也不知道被誰騙了居然選了 Scala，不過寫着寫着就發現 Scala 挺香的。&lt;/p&gt;\n&lt;h2&gt;changelog&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;2020 Mar.5: 加入 dotty 的 classpath 支援, 其他的因為我不用所以懶得加了&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;2020 Apr.13: 由於出現 OOM 了, 把 Xmx Xms 參數刪掉, 畢竟沒啥用&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&quot;],&quot;body&quot;:[0,&quot;真實年更*(:3」∠)*\n因為各種各樣的原因想試着日常用用 Scala 了，可是用作腳本的話編譯速度和啟動速度實在是太ー慢ー了，於是這裡就來試着調教一下讓 Scala 稍微能在日常用一點。\n\n## 編譯\n\n對於編譯其實沒有甚麼辦法，畢竟我菜。上網搜索了一會發現雖然有不少增量編譯等等，但似乎都是基於 sbt 等建構工具，一般都給大項目才能用，對腳本來說貌似意義不大。\n\n## Dotty\n\n再找找吧，發現 Scala 好像要出一個 Dotty 的編譯器，聽說編譯速度快了 20%？蚊子再小也是肉，趕緊下載一個來試試。\n嗯，所以要怎麼用呢，dotc 在哪裡，好像沒有 dotc.bat,好像不支持 Windows 。繼續搜搜，找到了大佬翻譯的 Windows 版的 Link，不錯。\n\n下載，編譯，崩潰，一氣呵成。\n![](./scala-script/Snipaste_2020-02-15_10-21-35.png)\n\n一看，原來 Dotty 改了不少格式，我都還沒開始學 Scala 2 就已經過氣了嗎。\n改了改，總算過了編譯，運行，崩潰，哦吼。\n![](./scala-script/Snipaste_2020-02-15_10-26-15.png)\n\n這甚麼，初始化崩潰？NPE?這玩意初始化時都干了甚麼？仔細想了想，有差別的地方可能是因為直接繼承了 App 而不寫 main 了？改改，過了，可是為甚麼呢？\n\n簡單推測一下，估計是 class 初始化時 args 還沒有被初始化，然後不知為甚麼(大概是 bug 吧)執行了本應該在 main 裡才執行的 parseArgs。然後就 NPE 了。\n\n## 增量編譯 (?)\n\n可是編譯還是好慢，不過雖然沒辦法繼續加快，但我可以減少編譯的次數嘛。於是，手寫了一個簡單的增量編譯，只在檔案有修改的時候才會重新編譯，雖然暫時只對單個檔案有效。\n\n```powershell\nparam($file, $cp, $run)\n\n$dest = \&quot;D:\\TEMP\&quot;\n$sourceDirectory = (Get-Item $file).DirectoryName\n$className = (Get-Item $file).Basename\n$destFile = $dest + $className + \&quot;.class\&quot;\n\n$A = Test-Path -Path $destFile\nif (-not $A -or ((Get-Item $destFile).LastWriteTime -lt (Get-Item $file).LastWriteTime)) {\n   # # for scala fsc\n   # fsc -d $dest $file\n   # for dotty\n   cmd /c \&quot;C:\\dotty-0.22.0-RC1\\bin\\dotc\&quot; \&quot;-classpath\&quot; \&quot;`\&quot;$sourceDirectory;$($cp -join \&quot;;\&quot;)`\&quot;\&quot; \&quot;-d\&quot; \&quot;`\&quot;$dest`\&quot;\&quot; \&quot;`\&quot;$file`\&quot;\&quot;\n   if(-not $?) {\n      exit\n   }\n}\n\n# faster startup (maybe)\n$JVM_ARGS = @(\&quot;-Xshare:on\&quot;, \&quot;-XX:-TieredCompilation\&quot;, \&quot;-XX:TieredStopAtLevel=1\&quot;, \&quot;-client\&quot; )\n$JVM_JARGS = @(\&quot;-JXshare:on\&quot;, \&quot;-JXX:-TieredCompilation\&quot;, \&quot;-JXX:TieredStopAtLevel=1\&quot;, \&quot;-Jclient\&quot; )\n# # for scala\n# java.exe @JVM_ARGS \&quot;-Dscala.usejavacp=true\&quot; \&quot;-cp\&quot; \&quot;C:\\scala\\lib\\*\&quot; \&quot;scala.tools.nsc.MainGenericRunner\&quot; @JVM_JARGS \&quot;-cp\&quot; $dest $className @run\n\n# for dotty\njava.exe @JVM_ARGS -classpath \&quot;C:\\DOTTY-~1.0-R\\lib\\dotty-library_0.22-0.22.0-RC1.jar;C:\\DOTTY-~1.0-R\\lib\\scala-library-2.13.1.jar;$($cp -join \&quot;;\&quot;);$dest\&quot; $className @run\n\n# # for classloader server mode\n# python D:\\palette\\Run\\cl.py $dest $className @run\n```\n\n這玩意非常簡單，只是檢查了一下最後修改時間，不過管用就行嘛。\n\n## 中段\n\n其實 dotty 的啟動速度已經到了可以接受的範圍了，但，有沒有辦法更快呢？\n\n## JVM\n\n事實上我們可以先把 JVM 開着，動態加載 Class，甚至複用 Class 來減少 JVM 和 Class 的載入時間。Github 上已經有 NailGun 和 Drip 實現了，可惜一個跑不起來(也許是 JDK 版本太高)一個不支援 Windows，只好自己做了，幸好並不算難寫。\n\n伺服器:\n\n```java\nimport java.io.File;\nimport java.lang.reflect.InvocationTargetException;\nimport java.lang.reflect.Method;\nimport java.net.URL;\nimport java.net.URLClassLoader;\nimport java.security.Permission;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.stream.Collectors;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.PrintStream;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.Socket;\n\npublic class CLServer {\n   private static final int PORT = 8080;\n   static final PrintStream _out = System.out;\n   static final PrintStream _err = System.err;\n   static ClassLoader cl;\n   static final boolean DEBUG = true;\n\n   public static void debug(String message) {\n      if (DEBUG) {\n         _out.print(\&quot;D&gt; \&quot;);\n         _out.println(message);\n      }\n   }\n\n   public static void error(String message) {\n      _out.print(\&quot;E&gt; \&quot;);\n      _out.println(message);\n   }\n\n   public static void info(String message) {\n      _out.print(\&quot;I&gt; \&quot;);\n      _out.println(message);\n   }\n\n   public static void main(String[] args) throws NoSuchMethodException, SecurityException, IllegalAccessException,\n         IllegalArgumentException, InvocationTargetException, IOException {\n      System.setSecurityManager(new SecurityManager() {\n         @Override\n         public void checkExit(int status) {\n            throw new RuntimeException(\&quot;Blocking System.exit();\&quot;);\n         }\n\n         @Override\n         public void checkPermission(Permission p) {\n\n         }\n      });\n\n      cl = URLClassLoader.newInstance(new URL[] {}, CLServer.class.getClassLoader());\n      addURL(\&quot;.\&quot;);\n\n      try (ServerSocket server = new ServerSocket(PORT)) {\n         info(\&quot;Server is listening \&quot; + PORT);\n\n         while (true) {\n            try {\n               try {\n                  Socket s = server.accept();\n                  handleSocket(s);\n               } catch (IOException e) {\n                  System.setOut(_out);\n                  System.setErr(_err);\n                  e.printStackTrace();\n               } finally {\n                  System.setOut(_out);\n                  System.setErr(_err);\n               }\n            } catch (Error | Exception e) {\n               debug(\&quot;continue anyway\&quot;);\n            }\n         }\n      }\n   }\n\n   public static void handleSocket(Socket s) throws IOException {\n      InputStream is = s.getInputStream();\n      PrintStream out = new PrintStream(s.getOutputStream());\n      BufferedReader in = new BufferedReader(new InputStreamReader(is));\n\n      System.setOut(out);\n      System.setErr(out);\n      try {\n         handleCommand(in, out);\n      } finally {\n         out.flush();\n         System.setOut(_out);\n         System.setErr(_err);\n         in.close();\n         out.close();\n         is.close();\n         s.close();\n      }\n   }\n\n   public static void handleCommand(BufferedReader in, PrintStream out) throws IOException {\n      debug(\&quot;Packet: \&quot;);\n      String cmd = in.readLine();\n      if (cmd.equals(\&quot;#cp\&quot;)) {\n         debug(\&quot;#cp\&quot;);\n         String data = in.readLine();\n         debug(data);\n         try {\n            CLServer.addURL(data);\n         } catch (Error | Exception e) {\n            e.printStackTrace(out);\n         }\n      } else if (cmd.equals(\&quot;#run\&quot;)) {\n         debug(\&quot;#run\&quot;);\n         ArrayList&lt;String&gt; cps = new ArrayList&lt;String&gt;();\n         String name = null;\n         ArrayList&lt;String&gt; args = new ArrayList&lt;String&gt;();\n         // 0 for cp, 1 for name, 2 for args\n         int state = 0;\n         String line;\n         while ((line = in.readLine()) != null &amp;&amp; line.length() &gt; 0) {\n            debug(line);\n            if (line.equals(\&quot;#cp\&quot;)) {\n               state = 0;\n            } else if (line.equals(\&quot;#name\&quot;)) {\n               state = 1;\n            } else if (line.equals(\&quot;#args\&quot;)) {\n               state = 2;\n            } else {\n               switch (state) {\n               case 0:\n                  cps.add(line);\n                  break;\n               case 1:\n                  name = line;\n                  break;\n               case 2:\n                  args.add(line);\n               }\n            }\n         }\n         if (name != null) {\n            CLServer.callMain(addTempURL(cps.toArray(new String[] {})), name, args.toArray(new String[] {}), out);\n         } else {\n            out.println(\&quot;E&gt; Missing class name\&quot;);\n            error(\&quot;Missing class name\&quot;);\n         }\n      }\n      debug(\&quot;End Packet\&quot;);\n   }\n\n   public static void addURL(String s) throws NoSuchMethodException, SecurityException, IllegalAccessException,\n         IllegalArgumentException, InvocationTargetException, MalformedURLException {\n      Method method = URLClassLoader.class.getDeclaredMethod(\&quot;addURL\&quot;, new Class[] { URL.class });\n\n      File f = new File(s);\n\n      method.setAccessible(true);\n      info(\&quot;Adding \&quot; + s);\n      method.invoke(cl, new Object[] { f.toURI().toURL() });\n   }\n\n   public static ClassLoader addTempURL(String[] s) throws MalformedURLException {\n\n      ClassLoader newCl = URLClassLoader.newInstance(Arrays.stream(s).map(x -&gt; {\n         try {\n            info(\&quot;Adding temp url \&quot; + x);\n            return new File(x).toURI().toURL();\n         } catch (MalformedURLException e) {\n            throw new RuntimeException(e);\n         }\n      }).collect(Collectors.toList()).toArray(new URL[] {}), cl);\n      return newCl;\n   }\n\n   public static void callMain(String className, String[] args, PrintStream out) {\n      callMain(cl, className, args, out);\n   }\n\n   public static void callMain(ClassLoader cl, String className, String[] args, PrintStream out) {\n      try {\n         info(\&quot;Running \&quot; + className);\n         cl.loadClass(className).getMethod(\&quot;main\&quot;, String[].class).invoke(null, (Object) args);\n      } catch (InvocationTargetException e) {\n         e.getCause().printStackTrace(out);\n      } catch (Error | Exception e) {\n         e.printStackTrace(out);\n      }\n   }\n}\n```\n\n客戶端:\n\n```python\nimport socket\nimport select\nimport sys\n\nhost = \&quot;127.0.0.1\&quot;\nport = 8080\n\ndef send(*data):\n   s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n   s.connect((host,port))\n   s.send((\&quot;\\n\&quot;.join(data) + \&quot;\\n\\n\\n\&quot;).encode())\n   ready = select.select([s], [], [], 10)\n   response = b\&quot;\&quot;\n   while True:\n      if ready[0]:\n         response = s.recv(1024)\n      if not response:\n         break\n      print(response.decode(), end=\&quot;\&quot;)\n   s.close ()\n\n# # for scala\n# send(\&quot;#cp\&quot;, \&quot;C:\\\\scala\\\\lib\\\\scala-compiler.jar\&quot;)\n# send(\&quot;#cp\&quot;, \&quot;C:\\\\scala\\\\lib\\\\scala-library.jar\&quot;)\n# send(\&quot;#run\&quot;,\n#    \&quot;#name\&quot;, \&quot;scala.tools.nsc.MainGenericRunner\&quot;,\n#    \&quot;#args\&quot;, \&quot;-Jclient\&quot;, \&quot;-cp\&quot;, \&quot;C:\\\\scala\\\\lib\\\\scala-library.jar;\&quot;+sys.argv[1],\n#    *sys.argv[2:]\n# )\n\n# for dotty\nsend(\&quot;#run\&quot;,\n   \&quot;#cp\&quot;, sys.argv[1],\n   \&quot;C:\\\\DOTTY-~1.0-R\\\\lib\\\\scala-library-2.13.1.jar\&quot;,\n   \&quot;C:\\\\DOTTY-~1.0-R\\\\lib\\\\dotty-library_0.22-0.22.0-RC1.jar\&quot;,\n   \&quot;#name\&quot;, sys.argv[2],\n   \&quot;#args\&quot;, *sys.argv[3:]\n)\n```\n\n代碼非常簡單，自定義了一套協議，用來加入 cp 和執行 main 函數，和一些不太好看的黑科技。\n可惜對 Dotty 的支持一般，不太清楚為甚麼但 Dotty 如果不每次加載的話輸出會消失，不過 Scala 沒這問題，而且 Dotty 的啟動其實也相當快，問題不大。\n\n## 結語\n\n代碼在 github 的 CodeColle/{Scala|Java}裡可以找到\n目前還只支持單文件，以後有機會/需求可能會再繼續弄吧，一開始是因為 Python 太慢所以想找個新語言，也不知道被誰騙了居然選了 Scala，不過寫着寫着就發現 Scala 挺香的。\n\n## changelog\n\n1. 2020 Mar.5: 加入 dotty 的 classpath 支援, 其他的因為我不用所以懶得加了\n\n2. 2020 Apr.13: 由於出現 OOM 了, 把 Xmx Xms 參數刪掉, 畢竟沒啥用\n&quot;]}],[0,{&quot;id&quot;:[0,&quot;wsl2-port-reserved&quot;],&quot;title&quot;:[0,&quot;WSL2/Hyper-V 端口佔用的 Workaround&quot;],&quot;pub_date&quot;:[3,&quot;2021-10-16T00:00:00.000Z&quot;],&quot;update_date&quot;:[0],&quot;excerpt&quot;:[0],&quot;categories&quot;:[0,&quot;Programming&quot;],&quot;tags&quot;:[1,[[0,&quot;WSL&quot;],[0,&quot;WSL2&quot;]]],&quot;draft&quot;:[0],&quot;thumbnail&quot;:[0],&quot;html&quot;:[0,&quot;&lt;p&gt;由於WSL2啟動後會佔用一大片 port 導致雖然完全沒有在用但就是 bind 不了，而且每次重開機都不一樣, 這裡記錄一個 workaround。&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# 以管理員模式運行&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# 53682 是需要開放的 port&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;net stop winnat&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;netsh int ipv4 add excludedportrange protocol&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;tcp startport&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;53682&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; numberofports&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;net start winnat&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;],&quot;body&quot;:[0,&quot;由於WSL2啟動後會佔用一大片 port 導致雖然完全沒有在用但就是 bind 不了，而且每次重開機都不一樣, 這裡記錄一個 workaround。\n\n```powershell\n# 以管理員模式運行\n\n# 53682 是需要開放的 port\nnet stop winnat\nnetsh int ipv4 add excludedportrange protocol=tcp startport=53682 numberofports=1\nnet start winnat\n```\n&quot;]}],[0,{&quot;id&quot;:[0,&quot;microg-playstore&quot;],&quot;title&quot;:[0,&quot;microG/NanoDroid 的 基本設置&quot;],&quot;pub_date&quot;:[3,&quot;2019-07-14T00:00:00.000Z&quot;],&quot;update_date&quot;:[0],&quot;excerpt&quot;:[0],&quot;categories&quot;:[0,&quot;Programming&quot;],&quot;tags&quot;:[1,[[0,0]]],&quot;draft&quot;:[0],&quot;thumbnail&quot;:[0],&quot;html&quot;:[0,&quot;&lt;h2&gt;0x0 前言&lt;/h2&gt;\n&lt;p&gt;&lt;em&gt;nanadroid 已不再更新，大概不建議繼續用，可以只看 microG 的部分&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;眾所周知, 最近谷歌爆出的一件又一件的的隠私問題, Don’t be evil 仿佛成了一個笑話,&lt;br&gt;作為用戶嘛..最好的選擇當然是不用啦!&lt;br&gt;(瞄了眼手中的 Android, 嗯…)&lt;br&gt;好吧好吧, 至少我們可以代替掉一些谷歌的服務, 比如用 microG&lt;/p&gt;\n&lt;h2&gt;0x1 開始之前?&lt;/h2&gt;\n&lt;p&gt;你至少需要以下東西&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;一部可以刷第三方 ROM 的 Android 手機 (當然&lt;/li&gt;\n&lt;li&gt;Magisk&lt;/li&gt;\n&lt;li&gt;擇一安裝&lt;ul&gt;\n&lt;li&gt;NanoDroid&lt;/li&gt;\n&lt;li&gt;microG Installer Revived&lt;br&gt;這裡就不教你裝 Magisk 了, 刷個 TWRP 刷個 magisk 就好, 谷歌一下吧 (嗯?)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;btw, LOS 就不用看了, 看了也用不了, 自行谷歌教學吧 &lt;a href=\&quot;https://lineage.microg.org\&quot;&gt;LineageOS for microG&lt;/a&gt;&lt;/p&gt;\n&lt;h2&gt;0x2 NanoDroid 的設置&lt;/h2&gt;\n&lt;p&gt;&lt;a href=\&quot;https://gitlab.com/Nanolx/NanoDroid\&quot;&gt;doc&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;簡單整理和翻譯一下, 不特別描述的都是 1 為打開 0 為關閉&lt;/p&gt;\n&lt;p&gt;首先在 &lt;code&gt;/sdcard&lt;/code&gt; &lt;code&gt;/data/media/0&lt;/code&gt; 和 zip 的位置 創建一個叫 &lt;code&gt;.nanodroid-setup&lt;/code&gt; 的配置檔案&lt;br&gt;填以下的配置, 然後刷 zip 就好了, 是不是很簡單ヽ(✿ ﾟ ▽ ﾟ)ノ&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;nanodroid_play=[0|1|2|3][0|1]&lt;/code&gt;&lt;br&gt;第一個數字:&lt;br&gt;0 = 啥都不裝&lt;br&gt;1 = Google Play&lt;br&gt;2 = Yalp Store // Google Play 代替品 1&lt;br&gt;3 = Aurora Store // Google Play 代替品 2, 比 Yalp 好看一點&lt;br&gt;第二個:&lt;br&gt;0 = 不裝 Fake Store&lt;br&gt;1 = Fake Store&lt;br&gt;&lt;code&gt;nanodroid_overlay=[0|1]&lt;/code&gt;&lt;br&gt;看上去是刪除一些系統的東西, Systemless 的可以放心使用&lt;br&gt;&lt;code&gt;nanodroid_mapsv1=[0|1]&lt;/code&gt;&lt;br&gt;啟用 microg v1 map api (我也不知道是啥)&lt;br&gt;&lt;code&gt;nanodroid_gsync=[0|1]&lt;/code&gt;&lt;br&gt;谷歌同步&lt;br&gt;&lt;code&gt;nanodroid_swipe=[0|1]&lt;/code&gt;&lt;br&gt;swipe(swype) 庫, 應該是某輸入法的庫, opengapps 裡也有, 但反正不知道有啥用&lt;br&gt;&lt;code&gt;nanodroid_forcesystem=[0|1]&lt;/code&gt;&lt;br&gt;裝到系統裡 (指非 Systemless/Magisk)&lt;br&gt;&lt;code&gt;nanodroid_nlpbackend=[0|1][0|1][0|1][0|1]&lt;/code&gt;&lt;br&gt;位置服務後端&lt;br&gt;0|1 = Déjà Vu location backend 逮蝦戶(誤)&lt;br&gt;0|1 = Ichnaea (Mozilla) location backend Mozilla 的&lt;br&gt;0|1 = Apple location backend 蘋果的&lt;br&gt;0|1 = Radiocells.org location backend 沒聽過&lt;/p&gt;\n&lt;h2&gt;0x2.1 microG Installer Revived&lt;/h2&gt;\n&lt;p&gt;沒甚麼配置可言&lt;br&gt;如果你需要 Google Play 的話需要下載&lt;a href=\&quot;https://nanolx.org/fdroid/repo/Phonesky_132.apk\&quot;&gt;Phonesky&lt;/a&gt;並放置到&lt;code&gt;/data/adb/Phonesky.apk&lt;/code&gt;&lt;/p&gt;\n&lt;h2&gt;0x3 安裝後的配置 (Google Play)&lt;/h2&gt;\n&lt;p&gt;&lt;em&gt;先別急着打開 Google Play 登錄, 不然之後你還得重新登出登錄一遍&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;打開 microG Settings, 裡面有個 Self-Check, 可以查看你離安裝成功還有多少東西要做&lt;br&gt;&lt;img loading=\&quot;lazy\&quot; decoding=\&quot;async\&quot; data-blurhash=\&quot;U3Qcr48_KN~W00W;t7jt00x[njIo00fkt7M{\&quot; width=\&quot;590\&quot; height=\&quot;1280\&quot; data-src=\&quot;/_posts/./microg-playstore/photo_2019-07-14_23-53-48.jpg?blurhash=U3Qcr48_KN~W00W%3Bt7jt00x%5BnjIo00fkt7M%7B&amp;width=590&amp;height=1280\&quot;  data-alt=\&quot;Self-Check\&quot; /&gt;&lt;br&gt;從上到下是&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;一般第三方 ROM 都支援, 不支援就…換一個系統吧&lt;/li&gt;\n&lt;li&gt;點一下就可以授權了&lt;/li&gt;\n&lt;li&gt;你可能需要到設定打開, 比如我的 Havoc 就在`設定 -&amp;gt; Havoc -&amp;gt; System -&amp;gt; System Spoof Signature&lt;/li&gt;\n&lt;li&gt;略略略&lt;/li&gt;\n&lt;li&gt;Play Store (Phonesky) correct signature 如果這個沒有的話在終端或 adb 輸入 su -c pm grant com.android.vending android.permission.FAKE_PACKAGE_SIGNATURE&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;之後的設定就和 Google Play 無關了&lt;/p&gt;\n&lt;p&gt;然後回到上一頁, 把 Google device registration GCM, SafetyNet 打開就好&lt;br&gt;然後你就可以愉快地使用 Google Play 啦&lt;/p&gt;\n&lt;h2&gt;0x4 Google Play 的代替品&lt;/h2&gt;\n&lt;p&gt;&lt;a href=\&quot;https://auroraoss.com/\&quot;&gt;Aurora Store&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;能下載 Google Play 上的應用&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&quot;https://f-droid.org/en/\&quot;&gt;F-Droid&lt;/a&gt;&lt;br&gt;嗯, F-Droid, FOSS (Free and open-source software) 應用市場, 不多說&lt;/p&gt;\n&lt;h2&gt;0x5 一些 microG 不支援的東西&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Google Play Game&lt;/li&gt;\n&lt;li&gt;Google Pay&lt;/li&gt;\n&lt;li&gt;Swift Backup (v3.5.0+後能用但不能直接通過 microG 登錄)&lt;/li&gt;\n&lt;li&gt;etc..&lt;/li&gt;\n&lt;/ul&gt;\n&quot;],&quot;body&quot;:[0,&quot;## 0x0 前言\n\n_nanadroid 已不再更新，大概不建議繼續用，可以只看 microG 的部分_\n\n眾所周知, 最近谷歌爆出的一件又一件的的隠私問題, Don’t be evil 仿佛成了一個笑話,\n作為用戶嘛..最好的選擇當然是不用啦!\n(瞄了眼手中的 Android, 嗯…)\n好吧好吧, 至少我們可以代替掉一些谷歌的服務, 比如用 microG\n\n## 0x1 開始之前?\n\n你至少需要以下東西\n\n1. 一部可以刷第三方 ROM 的 Android 手機 (當然\n2. Magisk\n3. 擇一安裝\n   - NanoDroid\n   - microG Installer Revived\n     這裡就不教你裝 Magisk 了, 刷個 TWRP 刷個 magisk 就好, 谷歌一下吧 (嗯?)\n\nbtw, LOS 就不用看了, 看了也用不了, 自行谷歌教學吧 [LineageOS for microG](https://lineage.microg.org)\n\n## 0x2 NanoDroid 的設置\n\n[doc](https://gitlab.com/Nanolx/NanoDroid)\n\n簡單整理和翻譯一下, 不特別描述的都是 1 為打開 0 為關閉\n\n首先在 `/sdcard` `/data/media/0` 和 zip 的位置 創建一個叫 `.nanodroid-setup` 的配置檔案\n填以下的配置, 然後刷 zip 就好了, 是不是很簡單ヽ(✿ ﾟ ▽ ﾟ)ノ\n\n`nanodroid_play=[0|1|2|3][0|1]`\n第一個數字:\n0 = 啥都不裝\n1 = Google Play\n2 = Yalp Store // Google Play 代替品 1\n3 = Aurora Store // Google Play 代替品 2, 比 Yalp 好看一點\n第二個:\n0 = 不裝 Fake Store\n1 = Fake Store\n`nanodroid_overlay=[0|1]`\n看上去是刪除一些系統的東西, Systemless 的可以放心使用\n`nanodroid_mapsv1=[0|1]`\n啟用 microg v1 map api (我也不知道是啥)\n`nanodroid_gsync=[0|1]`\n谷歌同步\n`nanodroid_swipe=[0|1]`\nswipe(swype) 庫, 應該是某輸入法的庫, opengapps 裡也有, 但反正不知道有啥用\n`nanodroid_forcesystem=[0|1]`\n裝到系統裡 (指非 Systemless/Magisk)\n`nanodroid_nlpbackend=[0|1][0|1][0|1][0|1]`\n位置服務後端\n0|1 = Déjà Vu location backend 逮蝦戶(誤)\n0|1 = Ichnaea (Mozilla) location backend Mozilla 的\n0|1 = Apple location backend 蘋果的\n0|1 = Radiocells.org location backend 沒聽過\n\n## 0x2.1 microG Installer Revived\n\n沒甚麼配置可言\n如果你需要 Google Play 的話需要下載[Phonesky](https://nanolx.org/fdroid/repo/Phonesky_132.apk)並放置到`/data/adb/Phonesky.apk`\n\n## 0x3 安裝後的配置 (Google Play)\n\n_先別急着打開 Google Play 登錄, 不然之後你還得重新登出登錄一遍_\n\n打開 microG Settings, 裡面有個 Self-Check, 可以查看你離安裝成功還有多少東西要做\n![Self-Check](./microg-playstore/photo_2019-07-14_23-53-48.jpg)\n從上到下是\n\n- 一般第三方 ROM 都支援, 不支援就…換一個系統吧\n- 點一下就可以授權了\n- 你可能需要到設定打開, 比如我的 Havoc 就在`設定 -&gt; Havoc -&gt; System -&gt; System Spoof Signature\n- 略略略\n- Play Store (Phonesky) correct signature 如果這個沒有的話在終端或 adb 輸入 su -c pm grant com.android.vending android.permission.FAKE_PACKAGE_SIGNATURE\n\n之後的設定就和 Google Play 無關了\n\n然後回到上一頁, 把 Google device registration GCM, SafetyNet 打開就好\n然後你就可以愉快地使用 Google Play 啦\n\n## 0x4 Google Play 的代替品\n\n[Aurora Store](https://auroraoss.com/)\n\n能下載 Google Play 上的應用\n\n[F-Droid](https://f-droid.org/en/)\n嗯, F-Droid, FOSS (Free and open-source software) 應用市場, 不多說\n\n## 0x5 一些 microG 不支援的東西\n\n- Google Play Game\n- Google Pay\n- Swift Backup (v3.5.0+後能用但不能直接通過 microG 登錄)\n- etc..\n&quot;]}],[0,{&quot;id&quot;:[0,&quot;py-interp&quot;],&quot;title&quot;:[0,&quot;一個用python寫的lisp解釋器&quot;],&quot;pub_date&quot;:[3,&quot;2017-04-01T00:00:00.000Z&quot;],&quot;update_date&quot;:[0],&quot;excerpt&quot;:[0,&quot;&lt;p&gt;這裡是一個年更blog主_(:3」∠)_&lt;/p&gt;\n&lt;p&gt;嘛這個語言是以全局只用一個map/dict, 但支援閉包為目標做的&lt;/p&gt;\n&quot;],&quot;categories&quot;:[0,&quot;Programming&quot;],&quot;tags&quot;:[1,[[0,0]]],&quot;draft&quot;:[0],&quot;thumbnail&quot;:[0],&quot;html&quot;:[0,&quot;&lt;p&gt;這裡是一個年更blog主_(:3」∠)_&lt;/p&gt;\n&lt;p&gt;嘛這個語言是以全局只用一個map/dict, 但支援閉包為目標做的&lt;/p&gt;\n&lt;!-- more --&gt;\n\n&lt;p&gt;這個語言長這樣&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(def x &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(print ((fn (y) x) &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; print 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(set x (lazy (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;do&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (print &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;x&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;))) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; 延時求值, 不可重複定義&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;x &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; print &amp;quot;x&amp;quot;, return 2&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;x &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; return 2&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(def (f) x)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(def (g x) (f))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(g &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; return 2, 閉包&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(def (k ...) (&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;apply&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ...)) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; 可變長參數&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(k &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; return 6&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(def (f1 $expr) (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;do&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (print &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;f1&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) (eval expr))) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; fexpr&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(f1 (print &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;f1,2&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; print &amp;quot;f1&amp;quot;, print &amp;quot;f1,2&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(def &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;define&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; def) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; 一切東西都是函數&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;define&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; lambda fn)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;define&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; Y (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;lambda&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;f&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;           ((&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;lambda&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;u&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) (u u))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;lambda&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;g&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                (f (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;lambda&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;x&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) ((g g) x)))))))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;((Y (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;lambda&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;f&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;        (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;lambda&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;x&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; x (f (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)))))))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; return 120&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(eval &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(print &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\n&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; print new line ; Quote&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0.1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0.2&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; return 0.30000000000000004 ;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(def (pwr b p) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; 快速幂&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;  (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;do&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    (def ans &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    (while (!= p &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;           (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;do&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;             (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&amp;amp; p &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; 位運算&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                 (set ans (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ans b))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                 )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;             (set b (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; b b))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;             (set p (shr p &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;             )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;           )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    ans&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;  )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(pwr &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;6&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; return 729&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;;快排&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;  (def (quicksort lst)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (. lst __len__) &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;        &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;&amp;#39;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;        (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #B31D28; font-style: italic\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;frist (. lst __getitem__ &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color: #B31D28; font-style: italic\&quot;&gt;]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;             &lt;/span&gt;&lt;span style=\&quot;color: #B31D28; font-style: italic\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;rest (split lst &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color: #B31D28; font-style: italic\&quot;&gt;]&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (quicksort (filter (fn (x) (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; x frist)) rest))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;       &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(,(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;do&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; frist))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;       (quicksort (filter (fn (x) (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; x frist)) rest)))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;    )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;  ))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(quicksort &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;4&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;46&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;465&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;8&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;58&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;41&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;81&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;6&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;84&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;8&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;; return &amp;#39;(1, 1, 4, 5, 5, 6, 8, 8, 41, 46, 58, 81, 84, 465)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;語法大概就長這個樣子, 功能上面也說得差不多了, 說說技術細節..&lt;/p&gt;\n&lt;p&gt;思路就是,&lt;/p&gt;\n&lt;p&gt;根作用域是一個None&lt;/p&gt;\n&lt;p&gt;每多一層作用域, 就把一個全局變量scopeID加1, 而下一層作用域就會是(scopeID, scope), 組成一個鏈表表示作用域篏套&lt;/p&gt;\n&lt;p&gt;而儲存/讀取變量時用作用域來識別要取的變量&lt;/p&gt;\n&lt;p&gt;函數閉包就直接保存作用域鏈表, 要儲存/讀取變量時, 直接用鏈表就可以讀取到創建環境的變量了&lt;/p&gt;\n&lt;p&gt;雖然但是, 這方法不能防止在外部變量改變時，閉包變量也會改變，類似 copy by reference 但我在scheme下測試&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292e\&quot;&gt;(define x 1)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292e\&quot;&gt;(define (f) x)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292e\&quot;&gt;(define x 2)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;(f) 是回傳 2 的…所以大概也不是甚麼大問題&lt;/p&gt;\n&quot;],&quot;body&quot;:[0,&quot;這裡是一個年更blog主_(:3」∠)_\n\n嘛這個語言是以全局只用一個map/dict, 但支援閉包為目標做的\n\n&lt;!-- more --&gt;\n\n這個語言長這樣\n\n```scheme\n(def x 1)\n(print ((fn (y) x) 1)) ; print 1\n(set x (lazy (do (print \&quot;x\&quot;) 2))) ; 延時求值, 不可重複定義\nx ; print \&quot;x\&quot;, return 2\nx ; return 2\n(def (f) x)\n(def (g x) (f))\n(g 1) ; return 2, 閉包\n(def (k ...) (apply + ...)) ; 可變長參數\n(k 1 2 3) ; return 6\n(def (f1 $expr) (do (print \&quot;f1\&quot;) (eval expr))) ; fexpr\n(f1 (print \&quot;f1,2\&quot;)) ; print \&quot;f1\&quot;, print \&quot;f1,2\&quot;\n(def define def) ; 一切東西都是函數\n(define lambda fn)\n(define Y (lambda (f)\n           ((lambda (u) (u u))\n            (lambda (g)\n                (f (lambda (x) ((g g) x)))))))\n((Y (lambda (f)\n        (lambda (x)\n            (if (= x 0)\n                1\n                (* x (f (- x 1)))))))\n 5) ; return 120\n(eval &#39;(print \&quot;\\n\&quot;)) ; print new line ; Quote\n(+ 0.1 0.2) ; return 0.30000000000000004 ;)\n(def (pwr b p) ; 快速幂\n  (do\n    (def ans 1)\n    (while (!= p 0)\n           (do\n             (if (= (&amp; p 1) 1) ; 位運算\n                 (set ans (* ans b))\n                 )\n             (set b (* b b))\n             (set p (shr p 1))\n             )\n           )\n    ans\n    )\n  )\n(pwr 3 6) ; return 729\n;快排\n  (def (quicksort lst)\n    (if (= (. lst __len__) 0)\n        &#39;()\n        (let ([frist (. lst __getitem__ 0)]\n             [rest (split lst 1)])\n    (+ (quicksort (filter (fn (x) (&lt; x frist)) rest))\n       &#39;(,(do frist))\n       (quicksort (filter (fn (x) (&gt;= x frist)) rest)))\n    )\n  ))\n(quicksort &#39;(5 4 46 465 1 8 58 5 41 81 6 84 1 8))\n; return &#39;(1, 1, 4, 5, 5, 6, 8, 8, 41, 46, 58, 81, 84, 465)\n```\n\n\n語法大概就長這個樣子, 功能上面也說得差不多了, 說說技術細節..\n\n思路就是,\n\n根作用域是一個None\n\n每多一層作用域, 就把一個全局變量scopeID加1, 而下一層作用域就會是(scopeID, scope), 組成一個鏈表表示作用域篏套\n\n而儲存/讀取變量時用作用域來識別要取的變量\n\n函數閉包就直接保存作用域鏈表, 要儲存/讀取變量時, 直接用鏈表就可以讀取到創建環境的變量了\n\n雖然但是, 這方法不能防止在外部變量改變時，閉包變量也會改變，類似 copy by reference 但我在scheme下測試\n\n```\n(define x 1)\n(define (f) x)\n(define x 2)\n```\n\n(f) 是回傳 2 的…所以大概也不是甚麼大問題\n&quot;]}],[0,{&quot;id&quot;:[0,&quot;first-step&quot;],&quot;title&quot;:[0,&quot;First Step&quot;],&quot;pub_date&quot;:[3,&quot;2017-01-25T00:00:00.000Z&quot;],&quot;update_date&quot;:[0],&quot;excerpt&quot;:[0,&quot;&lt;p&gt;&lt;img src=\&quot;/_posts/first-step/38973788_p0.png\&quot; alt=\&quot;38973788_p0.png\&quot;&gt;&lt;/p&gt;\n&lt;p&gt;人生中的第一個 blog&lt;/p&gt;\n&quot;],&quot;categories&quot;:[0,&quot;Daily&quot;],&quot;tags&quot;:[1,[[0,&quot;Blog&quot;]]],&quot;draft&quot;:[0],&quot;thumbnail&quot;:[0,&quot;/_posts/./first-step/38973788_p0.png&quot;],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;img loading=\&quot;lazy\&quot; decoding=\&quot;async\&quot; data-blurhash=\&quot;UTLhGEx^pIt8.8sTbcV?*0kWn$t7i_bvWBof\&quot; width=\&quot;3100\&quot; height=\&quot;1000\&quot; data-src=\&quot;/_posts/./first-step/38973788_p0.png?blurhash=UTLhGEx%5EpIt8.8sTbcV%3F*0kWn%24t7i_bvWBof&amp;width=3100&amp;height=1000\&quot;  data-alt=\&quot;38973788_p0.png\&quot; /&gt;&lt;/p&gt;\n&lt;p&gt;人生中的第一個 blog&lt;/p&gt;\n&lt;!-- more --&gt;\n\n&lt;p&gt;封面圖: pixiv 38973788&lt;/p&gt;\n&quot;],&quot;body&quot;:[0,&quot;![38973788_p0.png](./first-step/38973788_p0.png)\n\n人生中的第一個 blog\n\n&lt;!-- more --&gt;\n\n封面圖: pixiv 38973788\n&quot;]}]]]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;BlogCardList&quot;,&quot;value&quot;:&quot;solid-js&quot;}"></astro-island></main><astro-island uid="Z2bkQuQ" component-url="/_astro/Footer.f156fa86.js" component-export="default" renderer-url="/_astro/client.0aca0583.js" props="{}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Footer&quot;,&quot;value&quot;:&quot;solid-js&quot;}"></astro-island></body></html>