<!DOCTYPE html><html lang="en"><head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v3.5.2"><!-- Canonical URL --><link rel="canonical" href="https://paletteovo.moe/blog/scala-script/"><!-- Primary Meta Tags --><title>讓Scala的編譯和啟動快一丟丟</title><meta name="title" content="讓Scala的編譯和啟動快一丟丟"><meta name="description" content=""><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://paletteovo.moe/blog/scala-script/"><meta property="og:title" content="讓Scala的編譯和啟動快一丟丟"><meta property="og:description" content=""><meta property="og:image" content="https://paletteovo.moe/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://paletteovo.moe/blog/scala-script/"><meta property="twitter:title" content="讓Scala的編譯和啟動快一丟丟"><meta property="twitter:description" content=""><meta property="twitter:image" content="https://paletteovo.moe/blog-placeholder-1.jpg"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_name_.697908ee.css" />
<style>._article_lolpb_1{overflow-wrap:break-word;*{margin:14px 0}br {margin: 0;} h1,h2,h3,h4,h5,h6 {position: relative; margin: 24px 0; font-weight: 700; font-size: 1.25rem;} p {margin: 0 0 16px; line-height: 1.8; font-size: .875rem; opacity: .875;} li::marker {content: "- "; font-weight: 900;} li {margin-left: 1.2rem;} code {font-family: monospace;}}
</style><script type="module" src="/_astro/hoisted.124216b5.js"></script></head><body class="flex flex-col"><div class="bg-gradient w-100vw h-100vh fixed top-0 right-0 bottom-0 left-0 z--10000"></div><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var b=Object.defineProperty;var f=(c,o,i)=>o in c?b(c,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[o]=i;var l=(c,o,i)=>(f(c,typeof o!="symbol"?o+"":o,i),i);var p;{let c={0:t=>m(t),1:t=>i(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(i(t)),5:t=>new Set(i(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[e,r]=t;return e in c?c[e](r):void 0},i=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o(r)]));customElements.get("astro-island")||customElements.define("astro-island",(p=class extends HTMLElement{constructor(){super(...arguments);l(this,"Component");l(this,"hydrator");l(this,"hydrate",async()=>{var d;if(!this.hydrator||!this.isConnected)return;let e=(d=this.parentElement)==null?void 0:d.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let r=this.querySelectorAll("astro-slot"),a={},h=this.querySelectorAll("template[data-astro-template]");for(let n of h){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("data-astro-template")||"default"]=n.innerHTML,n.remove())}for(let n of r){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("name")||"default"]=n.innerHTML)}let u;try{u=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(n){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),n),n}await this.hydrator(this)(this.Component,u,a,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});l(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),r.disconnect(),this.childrenConnectedCallback()},r=new MutationObserver(()=>{var a;((a=this.lastChild)==null?void 0:a.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});r.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),r=this.getAttribute("client");if(Astro[r]===void 0){window.addEventListener(`astro:${r}`,()=>this.start(),{once:!0});return}Astro[r](async()=>{let a=this.getAttribute("renderer-url"),[h,{default:u}]=await Promise.all([import(this.getAttribute("component-url")),a?import(a):()=>()=>{}]),d=this.getAttribute("component-export")||"default";if(!d.includes("."))this.Component=h[d];else{this.Component=h;for(let n of d.split("."))this.Component=this.Component[n]}return this.hydrator=u,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},l(p,"observedAttributes",["props"]),p))}})();</script><astro-island uid="Z1p67UK" component-url="/_astro/Header.161332cb.js" component-export="default" renderer-url="/_astro/client.3f2697c3.js" props="{}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Header&quot;,&quot;value&quot;:&quot;solid-js&quot;}"></astro-island><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="11KfYJ" data-solid-render-id="s0" component-url="/_astro/TopBackground.ed8c9773.js" component-export="default" renderer-url="/_astro/client.3f2697c3.js" props="{&quot;class&quot;:[0,&quot;h-360px sm:h-540px lt-sm:justify-end lt-sm:p-8 sm:items-center sm:justify-center&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;TopBackground&quot;,&quot;value&quot;:true}" await-children=""><div data-hk="s00-0" id="top" class="h-360px sm:h-540px lt-sm:justify-end lt-sm:p-8 sm:items-center sm:justify-center top animate-fade-in animate-duration-500 w-full relative flex flex-col elevation-1"><!--$--><astro-slot><h1 data-hk="0-0" class="text-white text-3xl drop-shadow-md flex text-center">讓Scala的編譯和啟動快一丟丟</h1><div data-hk="0-1" class="mt-4 text-white drop-shadow-md flex opacity-80"><span class="flex items-center text-0.875rem"><div class="text-base mr-1 i-material-symbols:calendar-month-outline-rounded"></div><span class="mr-1 lt-sm:hidden">Created on</span><time datetime="2021-11-04T00:00:00.000Z">Nov 4, 2021</time></span><!--$--><!--/--></div></astro-slot><!--/--><div class="cursor-pointer absolute bottom-0 left-0 right-0 flex items-center justify-center pt-4 pb-2 drop-shadow-md"></div></div><!--astro:end--></astro-island><main class="bg-white flex-grow"><div class="h-16"></div><astro-island uid="Z1ThERF" component-url="/_astro/BlogPost.e8dc3b51.js" component-export="default" renderer-url="/_astro/client.3f2697c3.js" props="{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;scala-script&quot;],&quot;title&quot;:[0,&quot;讓Scala的編譯和啟動快一丟丟&quot;],&quot;pub_date&quot;:[3,&quot;2021-11-04T00:00:00.000Z&quot;],&quot;update_date&quot;:[0],&quot;excerpt&quot;:[0],&quot;categories&quot;:[0,&quot;Programming&quot;],&quot;tags&quot;:[1,[[0,0]]],&quot;draft&quot;:[0],&quot;thumbnail&quot;:[0],&quot;html&quot;:[0,&quot;&lt;p&gt;真實年更*(:3」∠)*&lt;br&gt;因為各種各樣的原因想試着日常用用 Scala 了，可是用作腳本的話編譯速度和啟動速度實在是太ー慢ー了，於是這裡就來試着調教一下讓 Scala 稍微能在日常用一點。&lt;/p&gt;\n&lt;h2&gt;編譯&lt;/h2&gt;\n&lt;p&gt;對於編譯其實沒有甚麼辦法，畢竟我菜。上網搜索了一會發現雖然有不少增量編譯等等，但似乎都是基於 sbt 等建構工具，一般都給大項目才能用，對腳本來說貌似意義不大。&lt;/p&gt;\n&lt;h2&gt;Dotty&lt;/h2&gt;\n&lt;p&gt;再找找吧，發現 Scala 好像要出一個 Dotty 的編譯器，聽說編譯速度快了 20%？蚊子再小也是肉，趕緊下載一個來試試。&lt;br&gt;嗯，所以要怎麼用呢，dotc 在哪裡，好像沒有 dotc.bat,好像不支持 Windows 。繼續搜搜，找到了大佬翻譯的 Windows 版的 Link，不錯。&lt;/p&gt;\n&lt;p&gt;下載，編譯，崩潰，一氣呵成。&lt;br&gt;&lt;img loading=\&quot;lazy\&quot; decoding=\&quot;async\&quot; data-blurhash=\&quot;U48NR%~CR%Rj^+nit7ozu4S~%Mxa?bWBR*jZ\&quot; width=\&quot;598\&quot; height=\&quot;176\&quot; data-src=\&quot;/_posts/scala-script/Snipaste_2020-02-15_10-21-35.png?blurhash=U48NR%25~CR%25Rj%5E%2Bnit7ozu4S~%25Mxa%3FbWBR*jZ&amp;width=598&amp;height=176\&quot;   /&gt;&lt;/p&gt;\n&lt;p&gt;一看，原來 Dotty 改了不少格式，我都還沒開始學 Scala 2 就已經過氣了嗎。&lt;br&gt;改了改，總算過了編譯，運行，崩潰，哦吼。&lt;br&gt;&lt;img loading=\&quot;lazy\&quot; decoding=\&quot;async\&quot; data-blurhash=\&quot;U5AmuS~q00Ri%Mt7%Mxu4nWB-;xa?cM{M{t7\&quot; width=\&quot;567\&quot; height=\&quot;175\&quot; data-src=\&quot;/_posts/scala-script/Snipaste_2020-02-15_10-26-15.png?blurhash=U5AmuS~q00Ri%25Mt7%25Mxu4nWB-%3Bxa%3FcM%7BM%7Bt7&amp;width=567&amp;height=175\&quot;   /&gt;&lt;/p&gt;\n&lt;p&gt;這甚麼，初始化崩潰？NPE?這玩意初始化時都干了甚麼？仔細想了想，有差別的地方可能是因為直接繼承了 App 而不寫 main 了？改改，過了，可是為甚麼呢？&lt;/p&gt;\n&lt;p&gt;簡單推測一下，估計是 class 初始化時 args 還沒有被初始化，然後不知為甚麼(大概是 bug 吧)執行了本應該在 main 裡才執行的 parseArgs。然後就 NPE 了。&lt;/p&gt;\n&lt;h2&gt;增量編譯 (?)&lt;/h2&gt;\n&lt;p&gt;可是編譯還是好慢，不過雖然沒辦法繼續加快，但我可以減少編譯的次數嘛。於是，手寫了一個簡單的增量編譯，只在檔案有修改的時候才會重新編譯，雖然暫時只對單個檔案有效。&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;param&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;($file&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $cp&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $run)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$dest &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;D:\\TEMP&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$sourceDirectory &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Get-Item&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $file).DirectoryName&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$className &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Get-Item&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $file).Basename&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$destFile &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $dest &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $className &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;.class&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$A &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Test-Path&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;Path $destFile&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-not&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $A &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-or&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ((&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Get-Item&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $destFile).LastWriteTime &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-lt&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;Get-Item&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $file).LastWriteTime)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# # for scala fsc&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# fsc -d $dest $file&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# for dotty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   cmd &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;c &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;C:\\dotty-0.22.0-RC1\\bin\\dotc&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-classpath&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$sourceDirectory&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$cp&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-join&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-d&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$dest&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$file&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;`&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-not&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;$?&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;exit&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# faster startup (maybe)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$JVM_ARGS &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;@&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-Xshare:on&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-XX:-TieredCompilation&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-XX:TieredStopAtLevel=1&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-client&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$JVM_JARGS &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;@&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-JXshare:on&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-JXX:-TieredCompilation&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-JXX:TieredStopAtLevel=1&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;-Jclient&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# # for scala&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# java.exe @JVM_ARGS &amp;quot;-Dscala.usejavacp=true&amp;quot; &amp;quot;-cp&amp;quot; &amp;quot;C:\\scala\\lib\\*&amp;quot; &amp;quot;scala.tools.nsc.MainGenericRunner&amp;quot; @JVM_JARGS &amp;quot;-cp&amp;quot; $dest $className @run&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# for dotty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;java.exe&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; @JVM_ARGS &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;classpath &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;C:\\DOTTY-~1.0-R\\lib\\dotty-library_0.22-0.22.0-RC1.jar;C:\\DOTTY-~1.0-R\\lib\\scala-library-2.13.1.jar;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;$&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$cp&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-join&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;$dest&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; $className @run&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# # for classloader server mode&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# python D:\\palette\\Run\\cl.py $dest $className @run&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;這玩意非常簡單，只是檢查了一下最後修改時間，不過管用就行嘛。&lt;/p&gt;\n&lt;h2&gt;中段&lt;/h2&gt;\n&lt;p&gt;其實 dotty 的啟動速度已經到了可以接受的範圍了，但，有沒有辦法更快呢？&lt;/p&gt;\n&lt;h2&gt;JVM&lt;/h2&gt;\n&lt;p&gt;事實上我們可以先把 JVM 開着，動態加載 Class，甚至複用 Class 來減少 JVM 和 Class 的載入時間。Github 上已經有 NailGun 和 Drip 實現了，可惜一個跑不起來(也許是 JDK 版本太高)一個不支援 Windows，只好自己做了，幸好並不算難寫。&lt;/p&gt;\n&lt;p&gt;伺服器:&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.File;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.lang.reflect.InvocationTargetException;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.lang.reflect.Method;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.URL;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.URLClassLoader;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.security.Permission;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.util.ArrayList;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.util.Arrays;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.util.stream.Collectors;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.BufferedReader;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.IOException;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.InputStream;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.InputStreamReader;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.io.PrintStream;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.MalformedURLException;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.ServerSocket;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; java.net.Socket;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;class&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;CLServer&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;private&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;final&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;int&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; PORT &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;8080&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;final&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; PrintStream _out &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; System.out;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;final&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; PrintStream _err &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; System.err;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ClassLoader cl;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;final&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;boolean&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; DEBUG &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;true&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;message&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (DEBUG) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;print&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;D&amp;gt; &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(message);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;error&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;message&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;print&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;E&amp;gt; &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(message);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;message&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;print&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;I&amp;gt; &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      _out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(message);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;main&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;args&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; NoSuchMethodException, SecurityException, IllegalAccessException,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         IllegalArgumentException, InvocationTargetException, IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setSecurityManager&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;SecurityManager&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         @&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;Override&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;checkExit&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;int&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;status&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throw&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;RuntimeException&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Blocking System.exit();&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         @&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;Override&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;checkPermission&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(Permission &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;p&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      });&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      cl &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; URLClassLoader.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;newInstance&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;URL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] {}, CLServer.class.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getClassLoader&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (ServerSocket server &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;ServerSocket&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(PORT)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Server is listening &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; PORT);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;while&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;true&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  Socket s &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; server.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;accept&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;handleSocket&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (IOException &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setOut&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setErr&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_err);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  e.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;printStackTrace&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;finally&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setOut&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setErr&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_err);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (Error | Exception &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;continue anyway&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;handleSocket&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(Socket &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      InputStream is &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; s.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getInputStream&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      PrintStream out &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;PrintStream&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(s.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getOutputStream&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      BufferedReader in &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;BufferedReader&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;InputStreamReader&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(is));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setOut&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setErr&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;handleCommand&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(in, out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;finally&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;flush&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setOut&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         System.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setErr&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(_err);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         in.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;close&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;close&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         is.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;close&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         s.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;close&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;handleCommand&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(BufferedReader &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, PrintStream &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;out&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Packet: &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      String cmd &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; in.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (cmd.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#cp&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#cp&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         String data &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; in.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(data);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            CLServer.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(data);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (Error | Exception &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            e.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;printStackTrace&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (cmd.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#run&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#run&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         ArrayList&amp;lt;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;&amp;gt; cps &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ArrayList&amp;lt;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;&amp;gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         String name &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         ArrayList&amp;lt;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;&amp;gt; args &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ArrayList&amp;lt;&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;&amp;gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;// 0 for cp, 1 for name, 2 for args&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;int&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; state &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         String line;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;while&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ((line &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; in.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;()) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;!=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; line.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;length&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (line.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#cp&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               state &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (line.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#name&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               state &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (line.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;equals&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#args&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               state &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;switch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (state) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;case&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  cps.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;add&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;break&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;case&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  name &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; line;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;break&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;case&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;                  args.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;add&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;               }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (name &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;!=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            CLServer.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;callMain&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addTempURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(cps.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toArray&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] {})), name, args.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toArray&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] {}), out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            out.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;E&amp;gt; Missing class name&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;error&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Missing class name&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;debug&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;End Packet&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; NoSuchMethodException, SecurityException, IllegalAccessException,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         IllegalArgumentException, InvocationTargetException, MalformedURLException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      Method method &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; URLClassLoader.class.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getDeclaredMethod&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;addURL&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;Class&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] { URL.class });&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      File f &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;File&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      method.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;setAccessible&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;true&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Adding &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      method.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;invoke&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(cl, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;Object&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] { f.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toURI&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;() });&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ClassLoader &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;addTempURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; MalformedURLException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      ClassLoader newCl &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; URLClassLoader.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;newInstance&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(Arrays.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;stream&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(s).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(x &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Adding temp url &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; x);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;return&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;File&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(x).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toURI&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toURL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (MalformedURLException &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;            &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;throw&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;RuntimeException&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(e);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(Collectors.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toList&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;()).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;toArray&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;URL&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] {}), cl);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;return&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; newCl;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;callMain&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;className&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;args&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, PrintStream &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;out&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;callMain&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(cl, className, args, out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;static&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;void&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;callMain&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(ClassLoader &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;cl&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, String &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;className&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;args&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, PrintStream &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;out&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;try&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;info&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;Running &amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; className);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         cl.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;loadClass&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(className).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getMethod&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;main&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;[].class).&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;invoke&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, (Object) args);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (InvocationTargetException &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         e.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;getCause&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;printStackTrace&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      } &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;catch&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; (Error | Exception &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;e&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         e.&lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;printStackTrace&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(out);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;客戶端:&lt;/p&gt;\n&lt;pre class=\&quot;shiki github-light\&quot; style=\&quot;background-color: #fff\&quot; tabindex=\&quot;0\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; socket&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; select&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; sys&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;host &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;127.0.0.1&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;port &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;8080&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;def&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #6F42C1\&quot;&gt;send&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;data):&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   s &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; socket.socket(socket.&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;AF_INET&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, socket.&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   s.connect((host,port))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   s.send((&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\n&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;.join(data) &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\n\\n\\n&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;).encode())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   ready &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; select.select([s], [], [], &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   response &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;b&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;while&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;True&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; ready[&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;]:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         response &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; s.recv(&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1024&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;if&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;not&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt; response:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;         &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;break&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;      &lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;print&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;(response.decode(), &lt;/span&gt;&lt;span style=\&quot;color: #E36209\&quot;&gt;end&lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   s.close ()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# # for scala&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# send(&amp;quot;#cp&amp;quot;, &amp;quot;C:\\\\scala\\\\lib\\\\scala-compiler.jar&amp;quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# send(&amp;quot;#cp&amp;quot;, &amp;quot;C:\\\\scala\\\\lib\\\\scala-library.jar&amp;quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# send(&amp;quot;#run&amp;quot;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;#    &amp;quot;#name&amp;quot;, &amp;quot;scala.tools.nsc.MainGenericRunner&amp;quot;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;#    &amp;quot;#args&amp;quot;, &amp;quot;-Jclient&amp;quot;, &amp;quot;-cp&amp;quot;, &amp;quot;C:\\\\scala\\\\lib\\\\scala-library.jar;&amp;quot;+sys.argv[1],&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;#    *sys.argv[2:]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# )&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #6A737D\&quot;&gt;# for dotty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;send(&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#run&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#cp&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, sys.argv[&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;],&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;C:&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;DOTTY-~1.0-R&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;lib&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;scala-library-2.13.1.jar&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;C:&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;DOTTY-~1.0-R&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;lib&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;\\\\&lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;dotty-library_0.22-0.22.0-RC1.jar&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#name&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, sys.argv[&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;],&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;   &lt;/span&gt;&lt;span style=\&quot;color: #032F62\&quot;&gt;&amp;quot;#args&amp;quot;&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color: #D73A49\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;sys.argv[&lt;/span&gt;&lt;span style=\&quot;color: #005CC5\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;:]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color: #24292E\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;代碼非常簡單，自定義了一套協議，用來加入 cp 和執行 main 函數，和一些不太好看的黑科技。&lt;br&gt;可惜對 Dotty 的支持一般，不太清楚為甚麼但 Dotty 如果不每次加載的話輸出會消失，不過 Scala 沒這問題，而且 Dotty 的啟動其實也相當快，問題不大。&lt;/p&gt;\n&lt;h2&gt;結語&lt;/h2&gt;\n&lt;p&gt;代碼在 github 的 CodeColle/{Scala|Java}裡可以找到&lt;br&gt;目前還只支持單文件，以後有機會/需求可能會再繼續弄吧，一開始是因為 Python 太慢所以想找個新語言，也不知道被誰騙了居然選了 Scala，不過寫着寫着就發現 Scala 挺香的。&lt;/p&gt;\n&lt;h2&gt;changelog&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;2020 Mar.5: 加入 dotty 的 classpath 支援, 其他的因為我不用所以懶得加了&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;2020 Apr.13: 由於出現 OOM 了, 把 Xmx Xms 參數刪掉, 畢竟沒啥用&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&quot;],&quot;body&quot;:[0,&quot;真實年更*(:3」∠)*\n因為各種各樣的原因想試着日常用用 Scala 了，可是用作腳本的話編譯速度和啟動速度實在是太ー慢ー了，於是這裡就來試着調教一下讓 Scala 稍微能在日常用一點。\n\n## 編譯\n\n對於編譯其實沒有甚麼辦法，畢竟我菜。上網搜索了一會發現雖然有不少增量編譯等等，但似乎都是基於 sbt 等建構工具，一般都給大項目才能用，對腳本來說貌似意義不大。\n\n## Dotty\n\n再找找吧，發現 Scala 好像要出一個 Dotty 的編譯器，聽說編譯速度快了 20%？蚊子再小也是肉，趕緊下載一個來試試。\n嗯，所以要怎麼用呢，dotc 在哪裡，好像沒有 dotc.bat,好像不支持 Windows 。繼續搜搜，找到了大佬翻譯的 Windows 版的 Link，不錯。\n\n下載，編譯，崩潰，一氣呵成。\n![](Snipaste_2020-02-15_10-21-35.png)\n\n一看，原來 Dotty 改了不少格式，我都還沒開始學 Scala 2 就已經過氣了嗎。\n改了改，總算過了編譯，運行，崩潰，哦吼。\n![](Snipaste_2020-02-15_10-26-15.png)\n\n這甚麼，初始化崩潰？NPE?這玩意初始化時都干了甚麼？仔細想了想，有差別的地方可能是因為直接繼承了 App 而不寫 main 了？改改，過了，可是為甚麼呢？\n\n簡單推測一下，估計是 class 初始化時 args 還沒有被初始化，然後不知為甚麼(大概是 bug 吧)執行了本應該在 main 裡才執行的 parseArgs。然後就 NPE 了。\n\n## 增量編譯 (?)\n\n可是編譯還是好慢，不過雖然沒辦法繼續加快，但我可以減少編譯的次數嘛。於是，手寫了一個簡單的增量編譯，只在檔案有修改的時候才會重新編譯，雖然暫時只對單個檔案有效。\n\n```powershell\nparam($file, $cp, $run)\n\n$dest = \&quot;D:\\TEMP\&quot;\n$sourceDirectory = (Get-Item $file).DirectoryName\n$className = (Get-Item $file).Basename\n$destFile = $dest + $className + \&quot;.class\&quot;\n\n$A = Test-Path -Path $destFile\nif (-not $A -or ((Get-Item $destFile).LastWriteTime -lt (Get-Item $file).LastWriteTime)) {\n   # # for scala fsc\n   # fsc -d $dest $file\n   # for dotty\n   cmd /c \&quot;C:\\dotty-0.22.0-RC1\\bin\\dotc\&quot; \&quot;-classpath\&quot; \&quot;`\&quot;$sourceDirectory;$($cp -join \&quot;;\&quot;)`\&quot;\&quot; \&quot;-d\&quot; \&quot;`\&quot;$dest`\&quot;\&quot; \&quot;`\&quot;$file`\&quot;\&quot;\n   if(-not $?) {\n      exit\n   }\n}\n\n# faster startup (maybe)\n$JVM_ARGS = @(\&quot;-Xshare:on\&quot;, \&quot;-XX:-TieredCompilation\&quot;, \&quot;-XX:TieredStopAtLevel=1\&quot;, \&quot;-client\&quot; )\n$JVM_JARGS = @(\&quot;-JXshare:on\&quot;, \&quot;-JXX:-TieredCompilation\&quot;, \&quot;-JXX:TieredStopAtLevel=1\&quot;, \&quot;-Jclient\&quot; )\n# # for scala\n# java.exe @JVM_ARGS \&quot;-Dscala.usejavacp=true\&quot; \&quot;-cp\&quot; \&quot;C:\\scala\\lib\\*\&quot; \&quot;scala.tools.nsc.MainGenericRunner\&quot; @JVM_JARGS \&quot;-cp\&quot; $dest $className @run\n\n# for dotty\njava.exe @JVM_ARGS -classpath \&quot;C:\\DOTTY-~1.0-R\\lib\\dotty-library_0.22-0.22.0-RC1.jar;C:\\DOTTY-~1.0-R\\lib\\scala-library-2.13.1.jar;$($cp -join \&quot;;\&quot;);$dest\&quot; $className @run\n\n# # for classloader server mode\n# python D:\\palette\\Run\\cl.py $dest $className @run\n```\n\n這玩意非常簡單，只是檢查了一下最後修改時間，不過管用就行嘛。\n\n## 中段\n\n其實 dotty 的啟動速度已經到了可以接受的範圍了，但，有沒有辦法更快呢？\n\n## JVM\n\n事實上我們可以先把 JVM 開着，動態加載 Class，甚至複用 Class 來減少 JVM 和 Class 的載入時間。Github 上已經有 NailGun 和 Drip 實現了，可惜一個跑不起來(也許是 JDK 版本太高)一個不支援 Windows，只好自己做了，幸好並不算難寫。\n\n伺服器:\n\n```java\nimport java.io.File;\nimport java.lang.reflect.InvocationTargetException;\nimport java.lang.reflect.Method;\nimport java.net.URL;\nimport java.net.URLClassLoader;\nimport java.security.Permission;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.stream.Collectors;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.PrintStream;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.Socket;\n\npublic class CLServer {\n   private static final int PORT = 8080;\n   static final PrintStream _out = System.out;\n   static final PrintStream _err = System.err;\n   static ClassLoader cl;\n   static final boolean DEBUG = true;\n\n   public static void debug(String message) {\n      if (DEBUG) {\n         _out.print(\&quot;D&gt; \&quot;);\n         _out.println(message);\n      }\n   }\n\n   public static void error(String message) {\n      _out.print(\&quot;E&gt; \&quot;);\n      _out.println(message);\n   }\n\n   public static void info(String message) {\n      _out.print(\&quot;I&gt; \&quot;);\n      _out.println(message);\n   }\n\n   public static void main(String[] args) throws NoSuchMethodException, SecurityException, IllegalAccessException,\n         IllegalArgumentException, InvocationTargetException, IOException {\n      System.setSecurityManager(new SecurityManager() {\n         @Override\n         public void checkExit(int status) {\n            throw new RuntimeException(\&quot;Blocking System.exit();\&quot;);\n         }\n\n         @Override\n         public void checkPermission(Permission p) {\n\n         }\n      });\n\n      cl = URLClassLoader.newInstance(new URL[] {}, CLServer.class.getClassLoader());\n      addURL(\&quot;.\&quot;);\n\n      try (ServerSocket server = new ServerSocket(PORT)) {\n         info(\&quot;Server is listening \&quot; + PORT);\n\n         while (true) {\n            try {\n               try {\n                  Socket s = server.accept();\n                  handleSocket(s);\n               } catch (IOException e) {\n                  System.setOut(_out);\n                  System.setErr(_err);\n                  e.printStackTrace();\n               } finally {\n                  System.setOut(_out);\n                  System.setErr(_err);\n               }\n            } catch (Error | Exception e) {\n               debug(\&quot;continue anyway\&quot;);\n            }\n         }\n      }\n   }\n\n   public static void handleSocket(Socket s) throws IOException {\n      InputStream is = s.getInputStream();\n      PrintStream out = new PrintStream(s.getOutputStream());\n      BufferedReader in = new BufferedReader(new InputStreamReader(is));\n\n      System.setOut(out);\n      System.setErr(out);\n      try {\n         handleCommand(in, out);\n      } finally {\n         out.flush();\n         System.setOut(_out);\n         System.setErr(_err);\n         in.close();\n         out.close();\n         is.close();\n         s.close();\n      }\n   }\n\n   public static void handleCommand(BufferedReader in, PrintStream out) throws IOException {\n      debug(\&quot;Packet: \&quot;);\n      String cmd = in.readLine();\n      if (cmd.equals(\&quot;#cp\&quot;)) {\n         debug(\&quot;#cp\&quot;);\n         String data = in.readLine();\n         debug(data);\n         try {\n            CLServer.addURL(data);\n         } catch (Error | Exception e) {\n            e.printStackTrace(out);\n         }\n      } else if (cmd.equals(\&quot;#run\&quot;)) {\n         debug(\&quot;#run\&quot;);\n         ArrayList&lt;String&gt; cps = new ArrayList&lt;String&gt;();\n         String name = null;\n         ArrayList&lt;String&gt; args = new ArrayList&lt;String&gt;();\n         // 0 for cp, 1 for name, 2 for args\n         int state = 0;\n         String line;\n         while ((line = in.readLine()) != null &amp;&amp; line.length() &gt; 0) {\n            debug(line);\n            if (line.equals(\&quot;#cp\&quot;)) {\n               state = 0;\n            } else if (line.equals(\&quot;#name\&quot;)) {\n               state = 1;\n            } else if (line.equals(\&quot;#args\&quot;)) {\n               state = 2;\n            } else {\n               switch (state) {\n               case 0:\n                  cps.add(line);\n                  break;\n               case 1:\n                  name = line;\n                  break;\n               case 2:\n                  args.add(line);\n               }\n            }\n         }\n         if (name != null) {\n            CLServer.callMain(addTempURL(cps.toArray(new String[] {})), name, args.toArray(new String[] {}), out);\n         } else {\n            out.println(\&quot;E&gt; Missing class name\&quot;);\n            error(\&quot;Missing class name\&quot;);\n         }\n      }\n      debug(\&quot;End Packet\&quot;);\n   }\n\n   public static void addURL(String s) throws NoSuchMethodException, SecurityException, IllegalAccessException,\n         IllegalArgumentException, InvocationTargetException, MalformedURLException {\n      Method method = URLClassLoader.class.getDeclaredMethod(\&quot;addURL\&quot;, new Class[] { URL.class });\n\n      File f = new File(s);\n\n      method.setAccessible(true);\n      info(\&quot;Adding \&quot; + s);\n      method.invoke(cl, new Object[] { f.toURI().toURL() });\n   }\n\n   public static ClassLoader addTempURL(String[] s) throws MalformedURLException {\n\n      ClassLoader newCl = URLClassLoader.newInstance(Arrays.stream(s).map(x -&gt; {\n         try {\n            info(\&quot;Adding temp url \&quot; + x);\n            return new File(x).toURI().toURL();\n         } catch (MalformedURLException e) {\n            throw new RuntimeException(e);\n         }\n      }).collect(Collectors.toList()).toArray(new URL[] {}), cl);\n      return newCl;\n   }\n\n   public static void callMain(String className, String[] args, PrintStream out) {\n      callMain(cl, className, args, out);\n   }\n\n   public static void callMain(ClassLoader cl, String className, String[] args, PrintStream out) {\n      try {\n         info(\&quot;Running \&quot; + className);\n         cl.loadClass(className).getMethod(\&quot;main\&quot;, String[].class).invoke(null, (Object) args);\n      } catch (InvocationTargetException e) {\n         e.getCause().printStackTrace(out);\n      } catch (Error | Exception e) {\n         e.printStackTrace(out);\n      }\n   }\n}\n```\n\n客戶端:\n\n```python\nimport socket\nimport select\nimport sys\n\nhost = \&quot;127.0.0.1\&quot;\nport = 8080\n\ndef send(*data):\n   s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n   s.connect((host,port))\n   s.send((\&quot;\\n\&quot;.join(data) + \&quot;\\n\\n\\n\&quot;).encode())\n   ready = select.select([s], [], [], 10)\n   response = b\&quot;\&quot;\n   while True:\n      if ready[0]:\n         response = s.recv(1024)\n      if not response:\n         break\n      print(response.decode(), end=\&quot;\&quot;)\n   s.close ()\n\n# # for scala\n# send(\&quot;#cp\&quot;, \&quot;C:\\\\scala\\\\lib\\\\scala-compiler.jar\&quot;)\n# send(\&quot;#cp\&quot;, \&quot;C:\\\\scala\\\\lib\\\\scala-library.jar\&quot;)\n# send(\&quot;#run\&quot;,\n#    \&quot;#name\&quot;, \&quot;scala.tools.nsc.MainGenericRunner\&quot;,\n#    \&quot;#args\&quot;, \&quot;-Jclient\&quot;, \&quot;-cp\&quot;, \&quot;C:\\\\scala\\\\lib\\\\scala-library.jar;\&quot;+sys.argv[1],\n#    *sys.argv[2:]\n# )\n\n# for dotty\nsend(\&quot;#run\&quot;,\n   \&quot;#cp\&quot;, sys.argv[1],\n   \&quot;C:\\\\DOTTY-~1.0-R\\\\lib\\\\scala-library-2.13.1.jar\&quot;,\n   \&quot;C:\\\\DOTTY-~1.0-R\\\\lib\\\\dotty-library_0.22-0.22.0-RC1.jar\&quot;,\n   \&quot;#name\&quot;, sys.argv[2],\n   \&quot;#args\&quot;, *sys.argv[3:]\n)\n```\n\n代碼非常簡單，自定義了一套協議，用來加入 cp 和執行 main 函數，和一些不太好看的黑科技。\n可惜對 Dotty 的支持一般，不太清楚為甚麼但 Dotty 如果不每次加載的話輸出會消失，不過 Scala 沒這問題，而且 Dotty 的啟動其實也相當快，問題不大。\n\n## 結語\n\n代碼在 github 的 CodeColle/{Scala|Java}裡可以找到\n目前還只支持單文件，以後有機會/需求可能會再繼續弄吧，一開始是因為 Python 太慢所以想找個新語言，也不知道被誰騙了居然選了 Scala，不過寫着寫着就發現 Scala 挺香的。\n\n## changelog\n\n1. 2020 Mar.5: 加入 dotty 的 classpath 支援, 其他的因為我不用所以懶得加了\n\n2. 2020 Apr.13: 由於出現 OOM 了, 把 Xmx Xms 參數刪掉, 畢竟沒啥用\n&quot;],&quot;mdx&quot;:[0]}]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;BlogPost&quot;,&quot;value&quot;:&quot;solid-js&quot;}"></astro-island><div class="h-16"></div></main><astro-island uid="2cT0yV" component-url="/_astro/Footer.24cc6891.js" component-export="default" renderer-url="/_astro/client.3f2697c3.js" props="{&quot;class&quot;:[0,&quot;flex&quot;]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Footer&quot;,&quot;value&quot;:&quot;solid-js&quot;}"></astro-island></body></html>